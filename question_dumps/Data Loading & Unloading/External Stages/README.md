# External Stages                                                                                                                                                                                                        
True or False: You can query the files in an External Stage directly without having to load the data into a table.                                                                                                       
                                                                                                                                                                                                                         
A. True<br>B. False                                                                                                                                                                                                      
                                                                                                                                                                                                                         
<details>                                                                                                                                                                                                                
<summary><strong>✅ Answer : </strong></summary>                                                                                                                                                                         
<strong>A</strong>                                                                                                                                                                                                       
                                                                                                                                                                                                                         
The statement is True. Snowflake allows querying files directly from external stages without requiring prior                                                                                                             
data loading into tables. This functionality is achieved through features like external tables and directory                                                                                                             
tables. External tables provide a read-only view of data files stored in cloud storage locations (e.g., Amazon                                                                                                           
S3, Azure Blob Storage, Google Cloud Storage). They act as a mapping between the file structure and a table                                                                                                              
schema within Snowflake. This lets you use SQL to query the data in these files without physically copying the                                                                                                           
data into Snowflake. Directory tables, on the other hand, let you browse and query files metadata within a                                                                                                               
stage, revealing details such as file names and sizes, but don't let you read the content directly. You can                                                                                                              
utilize directory tables in conjunction with external tables to filter specific files based on metadata before                                                                                                           
performing your queries. This capability enables efficient and flexible access to data lakes, reducing storage                                                                                                           
costs and minimizing data movement. By querying external stages directly, users can efficiently process vast                                                                                                             
datasets without the overhead of data ingestion. This approach is beneficial for ad-hoc analysis, data                                                                                                                   
exploration, and scenarios where data residency is a concern. Snowflake leverages metadata to effectively                                                                                                                
optimize queries on external data. The query engine applies necessary filtering on the cloud storage side                                                                                                                
whenever possible, further enhancing performance. This direct querying capability is fundamental to                                                                                                                      
Snowflake's data cloud vision, providing access to vast amounts of unstructured or semi-structured data in                                                                                                               
external storage.                                                                                                                                                                                                        
For further research, refer to the official Snowflake documentation:                                                                                                                                                     
External Tables: https://docs.snowflake.com/en/sql-reference/external-tables-intro                                                                                                                                       
Directory Tables: https://docs.snowflake.com/en/sql-reference/sql/create-directory-table                                                                                                                                 
</details>                                                                                                                                                                                                               
                                                                                                                                                                                                                         
                                                                                                                                                                                                                         
---                                                                                                                                                                                                                      
True or False: A Snowflake account is charged for data stored in both Internal and External Stages.                                                                                                                      
                                                                                                                                                                                                                         
A. True<br>B. False                                                                                                                                                                                                      
                                                                                                                                                                                                                         
<details>                                                                                                                                                                                                                
<summary><strong>✅ Answer : </strong></summary>                                                                                                                                                                         
<strong>B</strong>                                                                                                                                                                                                       
                                                                                                                                                                                                                         
The correct answer is False. Snowflake charges for data storage within its managed environment, which                                                                                                                    
includes Internal Stages. These stages reside within Snowflake's infrastructure, and the data they hold                                                                                                                  
consumes storage resources that are billed to the account. External Stages, however, point to data stored in                                                                                                             
your own external cloud storage (like AWS S3, Azure Blob Storage, or Google Cloud Storage). While                                                                                                                        
Snowflake interacts with this external data, it doesn't actually store the data itself within Snowflake's system.Consequently, you are not charged by Snowflake for the storage capacity consumed by the data residing in
your external cloud storage. The storage costs for data in External Stages are billed directly by the cloud                                                                                                              
provider (AWS, Azure, or Google) where the storage resides. Therefore, Snowflake accounts are charged for                                                                                                                
storage only on Internal Stages, and not External Stages. The costs associated with External Stages are                                                                                                                  
purely for compute resources used to process/query the data present in your storage location. In essence,                                                                                                                
Snowflake treats External Stages as pointers to your storage, not a part of its storage footprint. You bear the                                                                                                          
storage charges on your cloud provider account.                                                                                                                                                                          
For further information, you can refer to the official Snowflake documentation on:                                                                                                                                       
Understanding Data Storage Costs: https://docs.snowflake.com/en/user-guide/cost-understanding-storage                                                                                                                    
Stages: https://docs.snowflake.com/en/user-guide/data-load-stages                                                                                                                                                        
External Stages: https://docs.snowflake.com/en/user-guide/data-load-external-stages                                                                                                                                      
</details>                                                                                                                                                                                                               
                                                                                                                                                                                                                         
                                                                                                                                                                                                                         
---                                                                                                                                                                                                                      
Snowflake supports the use of external stages with which cloud platforms? (Choose three.)                                                                                                                                
                                                                                                                                                                                                                         
A. Amazon Web Services<br>B. Docker<br>C. IBM Cloud<br>D. Microsoft Azure Cloud<br>E. Google Cloud Platform<br>F. Oracle Cloud                                                                                           
                                                                                                                                                                                                                         
<details>                                                                                                                                                                                                                
<summary><strong>✅ Answer : </strong></summary>                                                                                                                                                                         
<strong>A, D, E</strong>                                                                                                                                                                                                 
                                                                                                                                                                                                                         
Snowflake's external stages allow direct access to data stored in cloud storage services, facilitating                                                                                                                   
seamless data loading and querying without requiring manual data movement. This functionality is crucial for                                                                                                             
modern data warehousing and analytics, enabling efficient processing of massive datasets. Snowflake                                                                                                                      
supports external stages with the three major public cloud providers: Amazon Web Services (AWS), Microsoft                                                                                                               
Azure, and Google Cloud Platform (GCP).                                                                                                                                                                                  
AWS integration leverages Amazon Simple Storage Service (S3) buckets for external data staging. Similarly,                                                                                                               
Azure supports Blob Storage containers, while GCP integrates with Google Cloud Storage buckets. These                                                                                                                    
integrations allow Snowflake to access and process data directly from these storage locations. Docker, IBM                                                                                                               
Cloud, and Oracle Cloud do not offer native integration for Snowflake's external stages. Therefore, options B,                                                                                                           
C, and F are incorrect.                                                                                                                                                                                                  
The chosen answer of A (Amazon Web Services), D (Microsoft Azure Cloud), and E (Google Cloud Platform)                                                                                                                   
aligns with Snowflake’s documented support for these platforms. This capability significantly reduces the                                                                                                                
complexity of managing data pipelines and promotes data accessibility. Each platform has specific                                                                                                                        
configuration requirements that must be met for seamless integration with Snowflake.                                                                                                                                     
For authoritative information, please refer to the following links:                                                                                                                                                      
1. Snowflake documentation on external stages: https://docs.snowflake.com/en/sqlreference/sql/create-stage.html#syntax                                                                                                   
2. Snowflake documentation on AWS S3: https://docs.snowflake.com/en/guides-aws-s3-config.html                                                                                                                            
3. Snowflake documentation on Azure Blob Storage: https://docs.snowflake.com/en/guides-azureconfig.html                                                                                                                  
4. Snowflake documentation on Google Cloud Storage: https://docs.snowflake.com/en/guides-gcpconfig.html                                                                                                                  
</details>                                                                                                                                                                                                               
                                                                                                                                                                                                                         
                                                                                                                                                                                                                         
---                                                                                                                                                                                                                      
A user has unloaded data from a Snowflake table to an external stage.                                                                                                                                                    
Which command can be used to verify if data has been uploaded to the external stage named my_stage?                                                                                                                      
                                                                                                                                                                                                                         
A. view @my_stage<br>B. list @my_stage<br>C. show @my_stage<br>D. display @my_stage                                                                                                                                      
                                                                                                                                                                                                                         
<details>                                                                                                                                                                                                                
<summary><strong>✅ Answer : </strong></summary>                                                                                                                                                                         
<strong>B</strong>                                                                                                                                                                                                       
                                                                                                                                                                                                                         
The correct answer is B. list @my_stage. Snowflake's LIST command is specifically designed to display the                                                                                                                
files located within a stage, whether internal or external. It's analogous to a directory listing in a traditional                                                                                                       
file system, providing the names of files, their sizes, and last modified timestamps. When data is unloaded to                                                                                                           
an external stage, such as AWS S3, Azure Blob Storage, or Google Cloud Storage, it's stored as files within                                                                                                              
that cloud storage location. LIST allows you to inspect the files present within that location via Snowflake's                                                                                                           
interface.                                                                                                                                                                                                               
Option A, view @my_stage, is not a valid command in Snowflake for listing files on stages. VIEW is used to                                                                                                               
create virtual tables based on the result-set of a query. Option C, show @my_stage, although a valid                                                                                                                     
Snowflake command, is typically used for showing stage definitions and metadata, not for listing the files                                                                                                               
within the stage. It will display information like the storage location, encryption details, etc., but not the actual                                                                                                    
data files. Lastly, display @my_stage is not a recognized command in Snowflake.                                                                                                                                          
Using LIST confirms the presence of files, ensuring that the unload operation was successful and the data is                                                                                                             
accessible within the designated external stage. This verification is crucial for downstream processes like                                                                                                              
data ingestion into other systems or further data processing tasks. Without verifying, one can't be certain data                                                                                                         
has landed on the intended external stage location.                                                                                                                                                                      
Supporting Links for further research:                                                                                                                                                                                   
Snowflake Documentation on LIST Command: https://docs.snowflake.com/en/sql-reference/sql/list                                                                                                                            
Snowflake Documentation on Stages: https://docs.snowflake.com/en/user-guide/data-load-unload-stages                                                                                                                      
</details>                                                                                                                                                                                                               
                                                                                                                                                                                                                         
                                                                                                                                                                                                                         
---                                                                                                                                                                                                                      
Which of the following is a valid source for an external stage when the Snowflake account is located on Microsoft                                                                                                        
                                                                                                                                                                                                                         
A. An FTP server with TLS encryption<br>B. An HTTPS server with WebDAV<br>C. A Google Cloud storage bucket<br>D. A Windows server file share on Azure                                                                    
                                                                                                                                                                                                                         
<details>                                                                                                                                                                                                                
<summary><strong>✅ Answer : </strong></summary>                                                                                                                                                                         
<strong>C</strong>                                                                                                                                                                                                       
                                                                                                                                                                                                                         
The correct answer is C. A Google Cloud storage bucket even though it seems counter-intuitive for an Azurelocated Snowflake account. Here's the justification:                                                           
Snowflake external stages are used to store data files outside of Snowflake but are accessible to Snowflake.                                                                                                             
The supported external stage locations depend on the cloud platform where your Snowflake account is                                                                                                                      
hosted. Specifically for Azure-hosted Snowflake accounts, Snowflake natively supports Azure Blob Storage.                                                                                                                
However, Snowflake's architecture allows accessing data from other cloud providers using what is often                                                                                                                   
referred to as Inter-Cloud Data Loading.                                                                                                                                                                                 
While direct access to a Windows server file share (SMB/CIFS) on Azure (option D) might seem logical for                                                                                                                 
Azure-hosted Snowflake, it's generally not the intended use case for external staging. Snowflake is designed                                                                                                             
to work with cloud-based object storage services, not directly mountable file systems. Option D is possible                                                                                                              
using the Azure Blob Storage interface and the built in file sharing capabilities for Azure Blob Storage and                                                                                                             
configuring Snowflake to use the correct access parameters.                                                                                                                                                              
Option A, FTP with TLS, is not a native external stage option supported by Snowflake directly. Snowflake is                                                                                                              
built for secure, scalable object storage, and FTP is a legacy protocol.                                                                                                                                                 
Option B, HTTPS with WebDAV, could theoretically be used, but it's far less efficient and less common thanusing a dedicated cloud storage service like Azure Blob Storage, AWS S3, or Google Cloud Storage. WebDAV       
is not a primary choice for bulk data loading into a data warehouse.                                                                                                                                                     
The key is that Snowflake offers connectors and integration capabilities to read data from various sources,                                                                                                              
even if they reside on a different cloud platform than where the Snowflake instance is running. Snowflake                                                                                                                
leverages cloud-to-cloud communication to facilitate this inter-cloud data loading. Therefore, while Azure                                                                                                               
Blob Storage is the "natural" choice for Azure Snowflake, a Google Cloud Storage bucket can serve as a valid                                                                                                             
source if the necessary Snowflake configuration is in place to access it, granting Snowflake's Azure account                                                                                                             
the appropriate permissions to access the Google Cloud Storage bucket. While option D is also technically                                                                                                                
possible, it is usually performed by wrapping the file share with Blob Storage.                                                                                                                                          
Further reading:                                                                                                                                                                                                         
Snowflake External Stages: https://docs.snowflake.com/en/user-guide/data-load-external-stages.html                                                                                                                       
Snowflake Data Loading: https://docs.snowflake.com/en/user-guide/data-load-overview.html                                                                                                                                 
Azure Blob Storage: https://learn.microsoft.com/en-us/azure/storage/blobs/storage-blobs-overview                                                                                                                         
</details>                                                                                                                                                                                                               
                                                                                                                                                                                                                         
                                                                                                                                                                                                                         
---                                                                                                                                                                                                                      
Which stage type can be altered and dropped?                                                                                                                                                                             
                                                                                                                                                                                                                         
A. Database stage<br>B. External stage<br>C. Table stage<br>D. User stage                                                                                                                                                
                                                                                                                                                                                                                         
<details>                                                                                                                                                                                                                
<summary><strong>✅ Answer : </strong></summary>                                                                                                                                                                         
<strong>B</strong>                                                                                                                                                                                                       
                                                                                                                                                                                                                         
The correct answer is B, External stage, because only external stages can be altered and dropped. Database                                                                                                               
stages, Table stages, and User stages are not independent objects that can be altered or dropped in the same                                                                                                             
way.                                                                                                                                                                                                                     
Here's a detailed justification:                                                                                                                                                                                         
Snowflake stages are named locations where data files are stored for loading into or unloading from                                                                                                                      
Snowflake tables. There are three main types of stages: internal stages (Database, Table, and User stages)                                                                                                               
and external stages (referencing cloud storage like AWS S3, Azure Blob Storage, or Google Cloud Storage).                                                                                                                
Internal stages (Database, User, and Table) are implicitly tied to the database, user, or table they are                                                                                                                 
associated with. They are not standalone objects that you create and drop independently. These stages are                                                                                                                
automatically created when the database, user, or table is created and implicitly removed when the object                                                                                                                
they are bound to is dropped. You cannot explicitly drop a database, user, or table stage as you can with                                                                                                                
external stages. You manage them indirectly through the containing object. You wouldn’t "alter" them in the                                                                                                              
same way you alter an external stage's configuration.                                                                                                                                                                    
External stages, on the other hand, are explicitly created using the CREATE STAGE command and are                                                                                                                        
standalone Snowflake objects. You define the connection to the external cloud storage location,                                                                                                                          
authentication details, file format options, and other relevant parameters. Because they are distinct objects,                                                                                                           
you can explicitly alter them using the ALTER STAGE command to change properties like encryption, fileformat, or the storage integration used for authentication. You can also explicitly drop them using the DROP       
STAGE command when they are no longer needed. This capability to alter and drop external stages provides                                                                                                                 
flexibility in managing your data loading and unloading processes.                                                                                                                                                       
Therefore, only external stages provide the explicit functionality to be altered (using ALTER STAGE) and                                                                                                                 
dropped (using DROP STAGE). The other stage types are managed implicitly through their associated                                                                                                                        
database, table or user.                                                                                                                                                                                                 
For further research and verification, refer to the Snowflake documentation on stages:                                                                                                                                   
Snowflake Stages                                                                                                                                                                                                         
CREATE STAGE                                                                                                                                                                                                             
ALTER STAGE                                                                                                                                                                                                              
DROP STAGE                                                                                                                                                                                                               
</details>                                                                                                                                                                                                               
                                                                                                                                                                                                                         
                                                                                                                                                                                                                         
---                                                                                                                                                                                                                      
A user is preparing to load data from an external stage.                                                                                                                                                                 
Which practice will provide the MOST efficient loading performance?                                                                                                                                                      
                                                                                                                                                                                                                         
A. Organize files into logical paths<br>B. Store the files on the external stage to ensure caching is maintained<br>C. Use pattern matching for regular expression execution<br>D. Load the data in one large file       
                                                                                                                                                                                                                         
<details>                                                                                                                                                                                                                
<summary><strong>✅ Answer : </strong></summary>                                                                                                                                                                         
<strong>A</strong>                                                                                                                                                                                                       
                                                                                                                                                                                                                         
The most efficient loading performance for data from an external stage in Snowflake is achieved by A.                                                                                                                    
Organize files into logical paths.                                                                                                                                                                                       
Here's why:                                                                                                                                                                                                              
Snowflake optimizes data loading by parallel processing, where multiple nodes ingest data concurrently.                                                                                                                  
Logically organizing files into separate paths enables Snowflake to leverage this parallelism more effectively.                                                                                                          
When files are grouped according to some logical criterion (e.g., date, source, type), Snowflake can easily                                                                                                              
identify distinct sets of files for parallel processing, reducing contention and accelerating the overall load.                                                                                                          
Imagine separate file paths for "2023-01-sales", "2023-02-sales" etc.; this makes processing much faster.                                                                                                                
Options B, C, and D are less impactful or can even be counterproductive:                                                                                                                                                 
B. Store the files on the external stage to ensure caching is maintained: External stage files are primarily                                                                                                             
stored on cloud storage (e.g., AWS S3, Azure Blob Storage, Google Cloud Storage) and don't have local                                                                                                                    
server-side caching mechanisms. While Snowflake may have an internal cache for some metadata, it won't                                                                                                                   
significantly improve loading performance compared to optimal file organization.                                                                                                                                         
C. Use pattern matching for regular expression execution: Pattern matching in COPY statements is useful                                                                                                                  
for selective loading but introduces processing overhead, which can slow down performance. It's best to                                                                                                                  
organize files well, so less complex matching is needed.                                                                                                                                                                 
D. Load the data in one large file: While fewer files mean less overhead in terms of file metadata, a single                                                                                                             
massive file limits Snowflake’s ability to process in parallel, reducing efficiency.                                                                                                                                     
In summary, effective file organization into logical paths best promotes parallel processing, leading to the                                                                                                             
most efficient data loading performance.                                                                                                                                                                                 
Authoritative Links:                                                                                                                                                                                                     
Snowflake Documentation on Loading Data: https://docs.snowflake.com/en/user-guide/data-load-overview                                                                                                                     
Snowflake Documentation on Data Loading Best Practices: https://docs.snowflake.com/en/user-guide/dataload-considerations-prepare                                                                                         
Snowflake Blog on Optimizing Data Loading: [Search "Optimizing Data Loading in Snowflake" on the                                                                                                                         
Snowflake blog for relevant articles.] (There's no direct link, and you will need to use the search feature).                                                                                                            
</details>                                                                                                                                                                                                               
                                                                                                                                                                                                                         
                                                                                                                                                                                                                         
---                                                                                                                                                                                                                      
Which function returns the URL of a stage using the stage name as the input?                                                                                                                                             
                                                                                                                                                                                                                         
A. BUILD_STAGE_FILE_URL<br>B. BUILD_SCOPED_FILE_URL<br>C. GET_PRESIGNED_URL<br>D. GET_STAGE_LOCATION                                                                                                                     
                                                                                                                                                                                                                         
<details>                                                                                                                                                                                                                
<summary><strong>✅ Answer : </strong></summary>                                                                                                                                                                         
<strong>D</strong>                                                                                                                                                                                                       
                                                                                                                                                                                                                         
The correct answer is D. GET_STAGE_LOCATION.                                                                                                                                                                             
The GET_STAGE_LOCATION function in Snowflake is specifically designed to retrieve the URL (or location) of                                                                                                               
a named internal stage. It takes the name of the stage as input and returns a string representing the URL                                                                                                                
where files within that stage are stored. This is essential for accessing files in a stage using external tools or                                                                                                       
when programmatically referencing them. Options A, B and C are not designed for returning just the stage                                                                                                                 
URL. The BUILD_STAGE_FILE_URL function might appear similar, but it's meant for generating URLs for                                                                                                                      
specific files within a stage, not just the stage's base URL. BUILD_SCOPED_FILE_URL generates presigned                                                                                                                  
urls for files on stages scoped to a user for a short period of time . GET_PRESIGNED_URL generates a                                                                                                                     
presigned URL for a single file, not for the entire stage. Unlike these other options, GET_STAGE_LOCATION                                                                                                                
provides a mechanism for obtaining the root path to stage in the cloud storage where your data is stored. The                                                                                                            
returned URL is the location to where you can push and retrieve data. This root path is useful for building                                                                                                              
automated pipelines that manipulate data on the stage, even before loading it into Snowflake tables. This                                                                                                                
function's output is a critical component in workflows where files on the stage are directly referenced via a                                                                                                            
URL, which is often necessary in integrations with other cloud services.                                                                                                                                                 
For further research, you can refer to the official Snowflake documentation:                                                                                                                                             
GET_STAGE_LOCATION: https://docs.snowflake.com/en/sql-reference/functions/get_stage_location                                                                                                                             
BUILD_STAGE_FILE_URL: https://docs.snowflake.com/en/sql-reference/functions/build_stage_file_url                                                                                                                         
GET_PRESIGNED_URL: https://docs.snowflake.com/en/sql-reference/functions/get_presigned_url                                                                                                                               
BUILD_SCOPED_FILE_URL: https://docs.snowflake.com/en/sql-reference/functions/build_scoped_file_url                                                                                                                       
</details>                                                                                                                                                                                                               
                                                                                                                                                                                                                         
                                                                                                                                                                                                                         
---                                                                                                                                                                                                                      
Which URL type should be used to get a permanent URL to a file in a stage?                                                                                                                                               
                                                                                                                                                                                                                         
A. File URL<br>B. Pre-signed URL<br>C. Saved URL<br>D. Scoped URL                                                                                                                                                        
                                                                                                                                                                                                                         
<details>                                                                                                                                                                                                                
<summary><strong>✅ Answer : </strong></summary>                                                                                                                                                                         
<strong>A</strong>                                                                                                                                                                                                       
                                                                                                                                                                                                                         
The correct answer is A. File URL. File URLs in Snowflake provide direct and permanent access to files                                                                                                                   
located within a stage. Unlike pre-signed URLs which are temporary and expire, or scoped URLs which are                                                                                                                  
designed for internal access, file URLs are persistent and ideal for situations where a consistent link isneeded, such as embedding images or linking to documents. These URLs point directly to the file's location     
within the Snowflake stage, allowing external systems to retrieve the content without additional                                                                                                                         
authentication mechanisms, provided the stage itself has appropriate access permissions set up. These                                                                                                                    
permissions are managed via Snowflake roles and privileges granted on the stage object. Snowflake handles                                                                                                                
the underlying storage access management; the file URL acts as a pointer to this data. Saved URLs are not a                                                                                                              
standard term in Snowflake's documentation relating to stage URLs. Essentially, using file URLs simplifies                                                                                                               
data access by directly referencing files stored in stages, eliminating the complexities of managing                                                                                                                     
temporary tokens or internal Snowflake contexts.                                                                                                                                                                         
For further research, please refer to the official Snowflake documentation on stage URLs:                                                                                                                                
Snowflake Documentation on File URLs                                                                                                                                                                                     
Snowflake Documentation on Managing Stages                                                                                                                                                                               
</details>                                                                                                                                                                                                               
                                                                                                                                                                                                                         
                                                                                                                                                                                                                         
---                                                                                                                                                                                                                      
How are URLs that access unstructured data in external stages retrieved?                                                                                                                                                 
                                                                                                                                                                                                                         
A. From the Snowsight navigation menu<br>B. By querying a directory table<br>C. By creating an external function<br>D. By using the INFORMATION_USAGE schema                                                             
                                                                                                                                                                                                                         
<details>                                                                                                                                                                                                                
<summary><strong>✅ Answer : </strong></summary>                                                                                                                                                                         
<strong>B</strong>                                                                                                                                                                                                       
                                                                                                                                                                                                                         
The correct answer is B. By querying a directory table. When working with external stages in Snowflake and                                                                                                               
accessing unstructured data (like files in cloud storage), you don't directly retrieve URLs through a navigation                                                                                                         
menu, create a function, or use the INFORMATION_SCHEMA. Instead, Snowflake provides a specific                                                                                                                           
mechanism to discover the URLs (or file paths) of these external files: directory tables.                                                                                                                                
Directory tables are special, read-only tables automatically created by Snowflake when you enable directory                                                                                                              
listings for an external stage. These tables contain metadata about the files located in the external stage,                                                                                                             
including file paths (which are effectively URLs in this context), file sizes, and last modification times. To                                                                                                           
access the file URLs, you query these directory tables using standard SQL. This approach allows you to                                                                                                                   
programmatically retrieve the locations of files within your external stage for further processing.                                                                                                                      
For instance, a query like SELECT relative_path FROM @my_external_stage/my_directory (FILE_FORMAT =>                                                                                                                     
'CSV', DIRECTORY => (ENABLE = TRUE)) would retrieve the file paths in the my_directory folder within your                                                                                                                
my_external_stage stage. The directory table enables granular control over access to file locations and                                                                                                                  
facilitates automated data pipelines. Snowflake's method ensures efficient retrieval and simplifies working                                                                                                              
with large amounts of unstructured data residing in external storage. This approach aligns with the principles                                                                                                           
of separating compute and storage in cloud data warehousing. The other options are not valid methods for                                                                                                                 
retrieving URLs of files in external stages.                                                                                                                                                                             
Here are some authoritative links for further research:                                                                                                                                                                  
Snowflake Documentation on Directory Tables: https://docs.snowflake.com/en/sqlreference/functions/directory                                                                                                              
Snowflake Documentation on External Tables: https://docs.snowflake.com/en/sql-reference/external-tables                                                                                                                  
Snowflake Documentation on Stages: https://docs.snowflake.com/en/user-guide/data-load-stages                                                                                                                             
</details>                                                                                                                                                                                                               
                                                                                                                                                                                                                         
                                                                                                                                                                                                                         
---                                                                                                                                                                                                                      
Which REST API can be used with unstructured data?                                                                                                                                                                       
                                                                                                                                                                                                                         
A. insertFiles<br>B. insertReport<br>C. GET /api/files/<br>D. loadHistoryScan                                                                                                                                            
                                                                                                                                                                                                                         
<details>                                                                                                                                                                                                                
<summary><strong>✅ Answer : </strong></summary>                                                                                                                                                                         
<strong>C</strong>                                                                                                                                                                                                       
                                                                                                                                                                                                                         
The correct answer is C. GET /api/files/. Snowflake’s support for unstructured data relies on its external                                                                                                               
stages and the capability to access these files via REST APIs. The GET /api/files/ endpoint allows retrieving                                                                                                            
information about files, including unstructured data files, stored in external stages configured within                                                                                                                  
Snowflake. While there isn’t a specific API call dedicated to “inserting” unstructured data as a single                                                                                                                  
operation, data is typically loaded into these external stages through cloud provider services or utilities like                                                                                                         
SnowSQL, then accessible within Snowflake using queries. The Snowflake REST API doesn't directly handle                                                                                                                  
the “insertion” of files; instead, it provides mechanisms to interact with files once they reside in an external                                                                                                         
stage. Options A and B, ‘insertFiles’ and ‘insertReport’, are not valid Snowflake REST API endpoints. Option D,                                                                                                          
loadHistoryScan, refers to a different API used for tracking data loading history, and it does not deal directly                                                                                                         
with unstructured data retrieval through a file path. Therefore, the GET /api/files/ endpoint is the most relevant                                                                                                       
option for interacting with unstructured data files stored in external stages using a REST API, allowing users                                                                                                           
to inspect, and potentially process information about files. This aligns with the principle of decoupling data                                                                                                           
storage from compute, leveraging the power of cloud storage to store unstructured data which can then be                                                                                                                 
queried by Snowflake.                                                                                                                                                                                                    
Authoritative Links:                                                                                                                                                                                                     
Snowflake REST API Overview: https://docs.snowflake.com/en/developer-guide/snowsight-api/rest-apioverview                                                                                                                
Snowflake External Stages: https://docs.snowflake.com/en/sql-reference/sql/create-stage                                                                                                                                  
Accessing Unstructured Data: https://docs.snowflake.com/en/guides-overview-unstructured-data                                                                                                                             
</details>                                                                                                                                                                                                               
                                                                                                                                                                                                                         
                                                                                                                                                                                                                         
---                                                                                                                                                                                                                      
Which file function generates a Snowflake-hosted file URL to a staged file using the stage name and relative file                                                                                                        
path as inputs?                                                                                                                                                                                                          
                                                                                                                                                                                                                         
A. BUILD_STAGE_FILE_URL<br>B. GET_ABSOLUTE_PATH<br>C. GET_RELATIVE_PATH<br>D. GET_STAGE_LOCATION                                                                                                                         
                                                                                                                                                                                                                         
<details>                                                                                                                                                                                                                
<summary><strong>✅ Answer : </strong></summary>                                                                                                                                                                         
<strong>A</strong>                                                                                                                                                                                                       
                                                                                                                                                                                                                         
The correct answer is A, BUILD_STAGE_FILE_URL. This function is specifically designed in Snowflake to                                                                                                                    
generate a URL that points to a file located within a defined stage (internal or external). It accepts the stage                                                                                                         
name and the relative path to the file within that stage as inputs. This enables Snowflake to construct a                                                                                                                
secure, resolvable URL for data access and manipulation. Options B, GET_ABSOLUTE_PATH, and C,                                                                                                                            
GET_RELATIVE_PATH, are not standard Snowflake functions related to generating file URLs within stages.                                                                                                                   
Option D, GET_STAGE_LOCATION, might return the stage's location URI, but it doesn’t directly generate a                                                                                                                  
file URL. Snowflake's file access control is managed through stage permissions and, with external stages,                                                                                                                
through cloud provider credentials. The BUILD_STAGE_FILE_URL function abstracts away the complexities                                                                                                                    
of building the URL, ensuring it follows the correct format and incorporates the necessary authentication. It is                                                                                                         
often used when you need to provide a reference to a file in a stage for use in other Snowflake operations or                                                                                                            
to share access (with appropriate controls) to the data outside Snowflake via signed URLs. Therefore, only                                                                                                               
BUILD_STAGE_FILE_URL fulfils the requirement of generating a Snowflake-hosted file URL from a stage                                                                                                                      
name and relative file path.https://docs.snowflake.com/en/sql-reference/functions/build_stage_file_url                                                                                                                   
</details>                                                                                                                                                                                                               
                                                                                                                                                                                                                         
                                                                                                                                                                                                                         
---                                                                                                                                                                                                                      
What is the Snowflake recommended Parquet file size when querying from external tables to optimize the number                                                                                                            
of parallel scanning operations?                                                                                                                                                                                         
                                                                                                                                                                                                                         
A. 1-16 MB<br>B. 16-128 MB<br>C. 100-250 MB<br>D. 256-512 MB                                                                                                                                                             
                                                                                                                                                                                                                         
<details>                                                                                                                                                                                                                
<summary><strong>✅ Answer : </strong></summary>                                                                                                                                                                         
<strong>C</strong>                                                                                                                                                                                                       
                                                                                                                                                                                                                         
The optimal Parquet file size for querying external tables in Snowflake, aiming to maximize parallel scanning                                                                                                            
operations, is indeed 100-250 MB (option C). Snowflake's architecture leverages massively parallel                                                                                                                       
processing (MPP), and it benefits from having a sufficient number of independent units of work to distribute                                                                                                             
across its compute resources. Smaller files, like those in the 1-128 MB range, can lead to an excessive number                                                                                                           
of scan tasks, creating overhead from task management and potentially underutilizing compute nodes.                                                                                                                      
Conversely, files larger than 250 MB reduce the parallelism, limiting the number of concurrent tasks, and can                                                                                                            
also result in longer processing times for individual files.                                                                                                                                                             
The 100-250 MB sweet spot strikes a balance. It provides enough data within each file to keep compute nodes                                                                                                              
busy while allowing Snowflake to create a substantial number of independent scan operations. This facilitates                                                                                                            
efficient utilization of Snowflake's distributed architecture, resulting in faster query performance and                                                                                                                 
minimized resource contention. External tables directly access data stored in external locations like S3, and                                                                                                            
therefore, optimal file sizing in source storage impacts query performance directly. Parquet is a columnar                                                                                                               
storage format, which enables Snowflake to read only necessary columns for queries, this, combined withrecommended file size, improves overall efficiency. This file size enables efficient splitting of data amongst    
multiple nodes for parallel reading without introducing the overhead of very small file processing. Using the                                                                                                            
recommended file size, Snowflake achieves optimal parallelism leading to faster query response times.                                                                                                                    
For further information on this topic, you can refer to the official Snowflake documentation:                                                                                                                            
https://docs.snowflake.com/en/user-guide/data-load-considerations-prepare.html#file-sizing-for-externaltablesand https://docs.snowflake.com/en/user-guide/data-load-considerations-prepare.htmlThese                     
documents provide guidance on data loading best practices and file sizing recommendations for optimized                                                                                                                  
performance with external tables.                                                                                                                                                                                        
</details>                                                                                                                                                                                                               
                                                                                                                                                                                                                         
                                                                                                                                                                                                                         
---                                                                                                                                                                                                                      
Which function generates a Snowflake hosted file URL to a staged file using the stage name and relative file path                                                                                                        
as inputs?                                                                                                                                                                                                               
                                                                                                                                                                                                                         
A. BUILD_STAGE_FILE_URL<br>B. BUILD_SCOPED_FILE_URL<br>C. GET_PRESIGNED_URL<br>D. GET_STAGE_LOCATION                                                                                                                     
                                                                                                                                                                                                                         
<details>                                                                                                                                                                                                                
<summary><strong>✅ Answer : </strong></summary>                                                                                                                                                                         
<strong>A</strong>                                                                                                                                                                                                       
                                                                                                                                                                                                                         
The correct answer is A. BUILD_STAGE_FILE_URL. This function is specifically designed within Snowflake to                                                                                                                
construct a URL that directly points to a file residing within a named internal stage. The function takes the                                                                                                            
stage name and the relative file path within that stage as its primary arguments. This URL, generated byBUILD_STAGE_FILE_URL, allows for accessing and interacting with the staged file. Option B,                       
BUILD_SCOPED_FILE_URL, is incorrect as it relates to URLs with specific scopes, not necessarily to stages.                                                                                                               
Option C, GET_PRESIGNED_URL, is used for external stages, providing temporary access using pre-signed                                                                                                                    
URLs, not Snowflake hosted ones. Option D, GET_STAGE_LOCATION, returns the location of the stage itself,                                                                                                                 
not the URL of a specific file. BUILD_STAGE_FILE_URL provides a straightforward method for developers to                                                                                                                 
obtain the precise address of their data files within Snowflake's internal storage system. This is crucial for                                                                                                           
data transformation, processing, and other operations where direct file access is needed via a URL. It removes                                                                                                           
the complexities of managing storage paths and generates a usable URL within the Snowflake environment.                                                                                                                  
This function does not provide external access. For more details, consult the official Snowflake                                                                                                                         
documentation: https://docs.snowflake.com/en/sql-reference/functions/build_stage_file_url.html                                                                                                                           
</details>                                                                                                                                                                                                               
                                                                                                                                                                                                                         
                                                                                                                                                                                                                         
---                                                                                                                                                                                                                      
How does a Snowflake user extract the URL of a directory table on an external stage for further transformation?                                                                                                          
                                                                                                                                                                                                                         
A. Use the SHOW STAGES command.<br>B. Use the DESCRIBE STAGE command.<br>C. Use the GET_ABSOLUTE_PATH function.<br>D. Use the GET_STAGE_LOCATION function.                                                               
                                                                                                                                                                                                                         
<details>                                                                                                                                                                                                                
<summary><strong>✅ Answer : </strong></summary>                                                                                                                                                                         
<strong>D</strong>                                                                                                                                                                                                       
                                                                                                                                                                                                                         
The correct answer is D. Use the GET_STAGE_LOCATION function. This function is specifically designed                                                                                                                     
within Snowflake to retrieve the fully qualified URL path for a given stage, including external stages.                                                                                                                  
Directory tables in Snowflake reference locations on these external stages, making GET_STAGE_LOCATION                                                                                                                    
the appropriate tool to extract their precise URL. Options A and B are incorrect because while SHOW STAGES                                                                                                               
lists available stages and DESCRIBE STAGE provides details about a specific stage's configuration, neither                                                                                                               
yields the direct, absolute URL of the stage, nor are they relevant for directory tables. Option C,                                                                                                                      
GET_ABSOLUTE_PATH, is not a valid Snowflake function. GET_STAGE_LOCATION takes the stage name asinput and produces the full path to the storage location. This path is essential when you need to access the             
files in the stage directly using other tools or when processing files within an external stage outside of                                                                                                               
Snowflake. This functionality is particularly crucial for scenarios where Snowflake acts as a data hub but                                                                                                               
relies on other systems to process data stored in the external stage, enabling data pipeline integrations. It                                                                                                            
allows integration with other tools or services that don't have direct access to Snowflake. Cloud storage, such                                                                                                          
as S3, Azure Blob Storage or Google Cloud Storage, all use URLs to access data, which is what                                                                                                                            
GET_STAGE_LOCATION returns. This URL can then be passed to other systems for file processing or                                                                                                                          
management, or even directly into other Snowflake queries if needed. Snowflake maintains the location path                                                                                                               
of the external stage within its internal metadata and the GET_STAGE_LOCATION function queries that                                                                                                                      
metadata to construct the full URL. In conclusion, GET_STAGE_LOCATION is the most suitable method                                                                                                                        
because it directly returns the necessary absolute path for external stage directories.                                                                                                                                  
Authoritative Links:                                                                                                                                                                                                     
Snowflake Documentation - GET_STAGE_LOCATION: https://docs.snowflake.com/en/sqlreference/functions/get_stage_location                                                                                                    
Snowflake Documentation - Directory Tables: https://docs.snowflake.com/en/sql-reference/external-tablesdirectory-tables                                                                                                  
Snowflake Documentation - Stages: https://docs.snowflake.com/en/user-guide/data-load-stages                                                                                                                              
</details>                                                                                                                                                                                                               
                                                                                                                                                                                                                         
                                                                                                                                                                                                                         
---                                                                                                                                                                                                                      
A Snowflake user needs to share unstructured data from an internal stage to a reporting tool that does not have                                                                                                          
Snowflake access.                                                                                                                                                                                                        
Which file function should be used?                                                                                                                                                                                      
                                                                                                                                                                                                                         
A. BUILD_SCOPED_FILE_URL<br>B. BUILD_STAGE_FILE_URL<br>C. GET_PRESIGNED_URL<br>D. GET_STAGE_LOCATION                                                                                                                     
                                                                                                                                                                                                                         
<details>                                                                                                                                                                                                                
<summary><strong>✅ Answer : </strong></summary>                                                                                                                                                                         
<strong>B</strong>                                                                                                                                                                                                       
                                                                                                                                                                                                                         
The correct answer is B. BUILD_STAGE_FILE_URL. Here's why:                                                                                                                                                               
The scenario requires sharing unstructured data from a Snowflake internal stage with an external reporting                                                                                                               
tool that lacks direct Snowflake access. This implies a need for a method that generates a publicly accessible                                                                                                           
URL to the file.                                                                                                                                                                                                         
BUILD_STAGE_FILE_URL is specifically designed to create a URL that allows access to files within a                                                                                                                       
Snowflake stage. This URL is not pre-signed or secured, making it suitable for the mentioned reporting tool                                                                                                              
since it does not need authentication with Snowflake. It constructs a direct, publicly accessible URL to the                                                                                                             
staged file.                                                                                                                                                                                                             
GET_PRESIGNED_URL, while also generating a URL, creates a time-limited and authenticated access URL.                                                                                                                     
This isn’t suitable as the reporting tool doesn't have credentials or a process to re-authenticate after each                                                                                                            
URL expiry. Similarly, GET_STAGE_LOCATION retrieves the location of the stage itself, not a URL for a                                                                                                                    
specific file. Lastly, BUILD_SCOPED_FILE_URL generates a URL only accessible through a scope, which will                                                                                                                 
not work in this scenario. It has to be publicly accessible without any authentication.                                                                                                                                  
In summary, BUILD_STAGE_FILE_URL is the appropriate function as it generates a simple, publiclyaccessible URL for a specific file in a Snowflake stage, fulfilling the requirement of sharing data with an               
external reporting tool without the complexity of authentication.                                                                                                                                                        
Authoritative Links:                                                                                                                                                                                                     
Snowflake Documentation on BUILD_STAGE_FILE_URL: https://docs.snowflake.com/en/sqlreference/functions/build_stage_file_url                                                                                               
Snowflake Documentation on GET_PRESIGNED_URL: https://docs.snowflake.com/en/sqlreference/functions/get_presigned_url                                                                                                     
Snowflake Documentation on GET_STAGE_LOCATION: https://docs.snowflake.com/en/sqlreference/functions/get_stage_location                                                                                                   
Snowflake Documentation on BUILD_SCOPED_FILE_URL: https://docs.snowflake.com/en/sqlreference/functions/build_scoped_file_url                                                                                             
</details>                                                                                                                                                                                                               
                                                                                                                                                                                                                         
                                                                                                                                                                                                                         
---                                                                                                                                                                                                                      
Which Snowflake URL type allows users or applications to download or access files directly from Snowflake stage                                                                                                          
without authentication?                                                                                                                                                                                                  
                                                                                                                                                                                                                         
A. Directory<br>B. File<br>C. Pre-signed<br>D. Scoped                                                                                                                                                                    
                                                                                                                                                                                                                         
<details>                                                                                                                                                                                                                
<summary><strong>✅ Answer : </strong></summary>                                                                                                                                                                         
<strong>C</strong>                                                                                                                                                                                                       
                                                                                                                                                                                                                         
The correct answer is C. Pre-signed URLs. Pre-signed URLs in Snowflake provide a mechanism to grant                                                                                                                      
temporary, time-limited access to files stored in stages without requiring explicit authentication. Unlike                                                                                                               
standard URLs, they embed authentication information directly into the URL itself. This allows any user or                                                                                                               
application possessing the URL to download or access the file, regardless of their Snowflake account                                                                                                                     
credentials. This approach is particularly useful for sharing data with external entities or integrating with                                                                                                            
applications that don't have direct access to Snowflake credentials. Directory and file URLs do not offer this                                                                                                           
level of controlled, unauthenticated access. Scoped URLs, while related to access control, don't grant                                                                                                                   
permission for direct access without authentication as pre-signed URLs do. Pre-signed URLs enable secure                                                                                                                 
data sharing while avoiding exposing sensitive credentials, a crucial aspect of cloud security. They follow the                                                                                                          
principle of least privilege by granting specific, time-bound access only when needed. Snowflake managesthe generation and expiration of these URLs. Therefore, they offer an efficient and secure method for data       
access, enhancing data sharing capabilities.                                                                                                                                                                             
Further research can be found at:                                                                                                                                                                                        
Snowflake Documentation on Pre-signed URLs                                                                                                                                                                               
Snowflake Documentation on Stages                                                                                                                                                                                        
</details>                                                                                                                                                                                                               
                                                                                                                                                                                                                         
                                                                                                                                                                                                                         
---                                                                                                                                                                                                                      
Which SQL command will list the files in a named stage?                                                                                                                                                                  
                                                                                                                                                                                                                         
A. list @~;<br>B. get @%mytable;<br>C. list @my_stage;<br>D. get @my_stage;                                                                                                                                              
                                                                                                                                                                                                                         
<details>                                                                                                                                                                                                                
<summary><strong>✅ Answer : </strong></summary>                                                                                                                                                                         
<strong>C</strong>                                                                                                                                                                                                       
                                                                                                                                                                                                                         
The correct SQL command to list files within a named stage in Snowflake is LIST @my_stage;.                                                                                                                              
Snowflake stages are named locations, either internal or external, where data files are stored                                                                                                                           
before being loaded into tables. The LIST command is specifically designed to display thecontents of these stages. Option C, list @my_stage;, accurately reflects this usage, where                                      
my_stage represents the name of the stage being queried. Options A, list @~;, and B, get                                                                                                                                 
@%mytable;, are incorrect. list @~; attempts to list files within the user stage, which may not be                                                                                                                       
the intended stage, and get @%mytable; is used to download files from a stage, not to list its                                                                                                                           
contents. Option D, get @my_stage;, is also incorrect for the same reason as B; it's for                                                                                                                                 
downloading, not listing. Therefore, list @my_stage; is the only command that fulfills the                                                                                                                               
requirement of listing files within a specified named stage. Snowflake's documentation clearly                                                                                                                           
outlines the usage of the LIST command for stage management and is the authoritative source for                                                                                                                          
this functionality.https://docs.snowflake.com/en/sql-reference/sql/list                                                                                                                                                  
</details>                                                                                                                                                                                                               
                                                                                                                                                                                                                         
                                                                                                                                                                                                                         
---                                                                                                                                                                                                                      
Which types of URLs are provided by Snowflake to access unstructured data files? (Choose two).                                                                                                                           
                                                                                                                                                                                                                         
A. Absolute URL<br>B. Dynamic URL<br>C. File URL<br>D. Relative URL<br>E. Scoped URL                                                                                                                                     
                                                                                                                                                                                                                         
<details>                                                                                                                                                                                                                
<summary><strong>✅ Answer : </strong></summary>                                                                                                                                                                         
<strong>C, E</strong>                                                                                                                                                                                                    
                                                                                                                                                                                                                         
The correct answer, C. File URL and E. Scoped URL, aligns with Snowflake's mechanisms for                                                                                                                                
accessing unstructured data. Snowflake utilizes File URLs to reference specific data files within a                                                                                                                      
stage (either internal or external). These URLs directly pinpoint the file's location, similar to how a                                                                                                                  
file path works in a local file system but within the Snowflake storage context. For example, a File                                                                                                                     
URL might look like s3://<bucket>/<path>/file.csv for an external stage on AWS S3.                                                                                                                                       
Furthermore, Snowflake employs Scoped URLs for secure, temporary access to files. These URLs                                                                                                                             
are dynamically generated and limited in their validity period, ensuring that data is only                                                                                                                               
accessible for a restricted time and to authorized users or processes. This approach enhances                                                                                                                            
security by mitigating the risk associated with long-lived credentials or URLs. Scoped URLs often                                                                                                                        
embed security tokens and permissions.                                                                                                                                                                                   
Options A, B, and D are not directly applicable to how Snowflake handles unstructured data URLs.                                                                                                                         
Absolute URLs, while a common URL type, are not how Snowflake explicitly labels their file                                                                                                                               
pointers. Dynamic URLs, while related in concept to Scoped URLs, aren't a specific term used by                                                                                                                          
Snowflake's documentation. Similarly, Relative URLs, which are used to specify paths based on                                                                                                                            
current context, aren't the method used by Snowflake for stage paths.                                                                                                                                                    
In summary, File URLs provide the direct path to a file in a stage, while Scoped URLs grant secure,                                                                                                                      
time-bound access. These two types are fundamental to how Snowflake manages and secures                                                                                                                                  
unstructured data access, with a focus on security and simplicity.                                                                                                                                                       
Authoritative Links:                                                                                                                                                                                                     
Snowflake Documentation - Loading Unstructured Data                                                                                                                                                                      
Snowflake Documentation - Stages                                                                                                                                                                                         
Snowflake Documentation - Generating Scoped URLs                                                                                                                                                                         
</details>                                                                                                                                                                                                               
                                                                                                                                                                                                                         
                                                                                                                                                                                                                         
---                                                                                                                                                                                                                      
Which file function gives a user or application access to download unstructured data from a Snowflake stage?                                                                                                             
                                                                                                                                                                                                                         
A. BUILD_SCOPED_FILE_URL<br>B. BUILD_STAGE_FILE_URL<br>C. GET_PRESIGNED_URL<br>D. GET_STAGE_LOCATION                                                                                                                     
                                                                                                                                                                                                                         
<details>                                                                                                                                                                                                                
<summary><strong>✅ Answer : </strong></summary>                                                                                                                                                                         
<strong>C</strong>                                                                                                                                                                                                       
                                                                                                                                                                                                                         
The correct answer is C. GET_PRESIGNED_URL. Snowflake's security model restricts direct                                                                                                                                  
access to its internal storage locations. Therefore, standard file system operations or URL                                                                                                                              
construction won't suffice for downloading data from stages. The GET_PRESIGNED_URL function                                                                                                                              
is explicitly designed to generate temporary, secure URLs that grant limited-time access to files                                                                                                                        
within a Snowflake stage. These URLs are pre-signed, meaning they include an authentication                                                                                                                              
token, allowing a user or application to download the data without requiring further Snowflake                                                                                                                           
credentials. This mechanism upholds Snowflake's security posture by preventing direct and longterm access to its storage.                                                                                                
Option A, BUILD_SCOPED_FILE_URL, isn't a recognized Snowflake function. Option B,                                                                                                                                        
BUILD_STAGE_FILE_URL, while conceptually similar, isn't a valid function either. It is important                                                                                                                         
to note that even if BUILD_STAGE_FILE_URL existed, it wouldn’t generate the pre-signed                                                                                                                                   
security credentials necessary for external access. Option D, GET_STAGE_LOCATION, returns                                                                                                                                
the stage's storage location, not a URL for file downloads. Accessing this location directly from                                                                                                                        
outside Snowflake's environment is typically forbidden. GET_PRESIGNED_URL, on the other                                                                                                                                  
hand, provides the temporary credentials necessary for download, adhering to principles of least                                                                                                                         
privilege and secure access management, vital in cloud environments. This function facilitates the                                                                                                                       
controlled and temporary sharing of unstructured data stored in Snowflake stages without                                                                                                                                 
compromising the security and integrity of the data platform.                                                                                                                                                            
For further research, refer to the Snowflake documentation on:                                                                                                                                                           
GET_PRESIGNED_URL Function: Specifically, this documentation page provides details on how                                                                                                                                
the GET_PRESIGNED_URL function operates, including its syntax, arguments, and return values.                                                                                                                             
Unstructured Data Stage Security: This page goes over security considerations when working                                                                                                                               
with stages and explains security best practices, such as using GET_PRESIGNED_URL for                                                                                                                                    
controlled access.                                                                                                                                                                                                       
</details>                                                                                                                                                                                                               
                                                                                                                                                                                                                         
                                                                                                                                                                                                                         
---                                                                                                                                                                                                                      
Which function generates a Snowflake-hosted file URL to a staged file using the stage name and relative file path                                                                                                        
as inputs, with a file URL that does not expire?                                                                                                                                                                         
                                                                                                                                                                                                                         
A. BUILD_SCOPED_FILE_URL<br>B. BUILD_STAGE_FILE_URL<br>C. GET_ABSOLUTE_PATH<br>D. GET_PRESIGNED_URL                                                                                                                      
                                                                                                                                                                                                                         
<details>                                                                                                                                                                                                                
<summary><strong>✅ Answer : </strong></summary>                                                                                                                                                                         
<strong>B</strong>                                                                                                                                                                                                       
                                                                                                                                                                                                                         
The correct answer is B. BUILD_STAGE_FILE_URL. This function is specifically designed                                                                                                                                    
in Snowflake to create a publicly accessible URL for a file stored in an internal stage.                                                                                                                                 
Unlike other cloud object storage solutions, Snowflake manages file access through                                                                                                                                       
these generated URLs, which are essential for accessing staged data outside of                                                                                                                                           
Snowflake's query environment, such as for use in other applications or web browsers.                                                                                                                                    
BUILD_STAGE_FILE_URL takes two primary inputs: the name of the stage where the file                                                                                                                                      
resides and the relative path to the specific file within that stage. The generated URL                                                                                                                                  
provides read-only access to the file. Importantly, using this function inherently creates                                                                                                                               
a non-expiring URL, unlike temporary presigned URLs used by other cloud providers.                                                                                                                                       
This allows for consistent access to the file without the need to periodically refresh or                                                                                                                                
regenerate the URL. Options A, C, and D do not correctly fulfil the requirement.                                                                                                                                         
BUILD_SCOPED_FILE_URL is not a valid Snowflake function name.                                                                                                                                                            
GET_ABSOLUTE_PATH is a string manipulation function that provides the absolute path                                                                                                                                      
of a file in the stage, it does not generate URLs. GET_PRESIGNED_URL is for creating                                                                                                                                     
temporary URL's with expiry time limits, which is not the criteria in the question.                                                                                                                                      
The security implications of providing these URLs should be considered, as any user with                                                                                                                                 
the URL can access the file. It's crucial to ensure the data stored in these stages is                                                                                                                                   
appropriately secured. Snowflake provides granular access control mechanisms via                                                                                                                                         
stage permissions to manage the source files before they are accessible via URLs                                                                                                                                         
generated with BUILD_STAGE_FILE_URL.                                                                                                                                                                                     
Authoritative Links:                                                                                                                                                                                                     
Snowflake Documentation on BUILD_STAGE_FILE_URL:                                                                                                                                                                         
https://docs.snowflake.com/en/sql-reference/functions/build_stage_file_url.html                                                                                                                                          
Snowflake Documentation on Internal Stages: https://docs.snowflake.com/en/sqlreference/sql/create-stage.html                                                                                                             
</details>                                                                                                                                                                                                               
                                                                                                                                                                                                                         
                                                                                                                                                                                                                         
---                                                                                                                                                                                                                      
What is the primary purpose of partitioning staged data files for regular data loads?                                                                                                                                    
                                                                                                                                                                                                                         
A. To improve the performance of data loads<br>B. To compress the data for efficient storage<br>C. To encrypt the data for enhanced security<br>D. To organize the data into subfolders for easy browsing                
                                                                                                                                                                                                                         
<details>                                                                                                                                                                                                                
<summary><strong>✅ Answer : </strong></summary>                                                                                                                                                                         
<strong>D</strong>                                                                                                                                                                                                       
                                                                                                                                                                                                                         
The correct answer is D. To organize the data into subfolders for easy browsing.                                                                                                                                         
While partitioning can indirectly influence load performance, its primary purpose in                                                                                                                                     
staging is organizational. When data files are loaded into Snowflake from cloud storage,                                                                                                                                 
Snowflake needs to access them. Structuring the staged data into subfolders makes it                                                                                                                                     
easier for users and Snowflake to browse and locate specific data files. This hierarchical                                                                                                                               
organization is particularly helpful when dealing with large datasets or a high volume of                                                                                                                                
files, enhancing maintainability and enabling more targeted load operations.                                                                                                                                             
Partitioning, in this context, essentially involves creating a logical structure using                                                                                                                                   
subfolders within the cloud storage. Options A, B, and C are secondary effects of                                                                                                                                        
structuring data within cloud storage but they are not the primary reason for partitioning                                                                                                                               
files at the staging level. For instance, although compression might reduce the amount                                                                                                                                   
of data transferred, and encryption could be applied to the cloud storage, those are not                                                                                                                                 
primary reasons for partitioning the data in staged files before loading to Snowflake. The                                                                                                                               
central reason is to establish a structured, searchable file system within the staging                                                                                                                                   
area itself. This allows for simpler, more efficient data management.                                                                                                                                                    
For further reading on staging data and Snowflake, refer to the official Snowflake                                                                                                                                       
documentation:                                                                                                                                                                                                           
Loading Data from Staged Files                                                                                                                                                                                           
Prepare Files for Loading                                                                                                                                                                                                
</details>                                                                                                                                                                                                               
                                                                                                                                                                                                                         
                                                                                                                                                                                                                         
---                                                                                                                                                                                                                      
What commands can be used to see what files are stored in a stage? (Choose two.)                                                                                                                                         
                                                                                                                                                                                                                         
A. LIST<br>B. SELECT<br>C. LS<br>D. GET<br>E. DESCRIBE                                                                                                                                                                   
                                                                                                                                                                                                                         
<details>                                                                                                                                                                                                                
<summary><strong>✅ Answer : </strong></summary>                                                                                                                                                                         
<strong>A, C</strong>                                                                                                                                                                                                    
                                                                                                                                                                                                                         
The correct options are A. LIST and C. LS. Both the LIST and LS commands within                                                                                                                                          
Snowflake are designed to display information about the files located within a specified                                                                                                                                 
stage. A stage in Snowflake acts as a designated storage location, such as an internal                                                                                                                                   
Snowflake stage or an external stage connected to cloud storage like AWS S3 or Azure                                                                                                                                     
Blob Storage. The LIST command provides a more structured output, presenting details                                                                                                                                     
like the file's name, size, and last modified date. The LS command, effectively an alias for                                                                                                                             
LIST, functions identically, offering a more concise way to accomplish the same task. In                                                                                                                                 
contrast, SELECT is used for querying data within tables, not examining stage contents.                                                                                                                                  
GET is used for downloading files from a stage, not for listing their contents. DESCRIBE                                                                                                                                 
is utilized to show metadata about schema objects like tables, views, or stages                                                                                                                                          
themselves, not the files within a stage. Therefore, LIST and LS are the specific                                                                                                                                        
commands designed for inspecting the files stored in a Snowflake stage.                                                                                                                                                  
For more detailed information on these commands, please refer to the official Snowflake                                                                                                                                  
documentation:LIST (SnowSQL): https://docs.snowflake.com/en/sql-reference/sql/list.html                                                                                                                                  
LS (SnowSQL): https://docs.snowflake.com/en/sql-reference/sql/list.html#ls                                                                                                                                               
</details>                                                                                                                                                                                                               
                                                                                                                                                                                                                         
                                                                                                                                                                                                                         
---                                                                                                                                                                                                                      
While working with unstructured data, which file function generates a Snowflake-hosted file URL to a staged file                                                                                                         
using the stage name and relative file path as inputs?                                                                                                                                                                   
                                                                                                                                                                                                                         
A. BUILD_STAGE_FILE_URL<br>B. GET_ABSOLUTE_PATH<br>C. BUILD_SCOPED_FILE_URL<br>D. GET_PRESIGNED_URL                                                                                                                      
                                                                                                                                                                                                                         
<details>                                                                                                                                                                                                                
<summary><strong>✅ Answer : </strong></summary>                                                                                                                                                                         
<strong>A</strong>                                                                                                                                                                                                       
                                                                                                                                                                                                                         
The correct answer is A. BUILD_STAGE_FILE_URL. This function is specifically designed                                                                                                                                    
in Snowflake to create a publicly accessible URL for files stored in a designated stage.                                                                                                                                 
The function requires the name of the stage and the relative path to the file within that                                                                                                                                
stage as inputs. Snowflake manages the underlying infrastructure and generates a                                                                                                                                         
unique URL that can be used to access the file. This is essential when working with                                                                                                                                      
unstructured data, as it allows you to access the files for processing and analysis from                                                                                                                                 
other applications.                                                                                                                                                                                                      
Option B, GET_ABSOLUTE_PATH, is not a valid function within Snowflake for URL                                                                                                                                            
generation. It is not used for file access purposes. Option C, BUILD_SCOPED_FILE_URL,                                                                                                                                    
does not exist in Snowflake's SQL function library. Option D, GET_PRESIGNED_URL, is                                                                                                                                      
related to accessing files in cloud storage like AWS S3, but it is not a Snowflake function                                                                                                                              
used for local stage URL generation. The pre-signed URLs generated using external                                                                                                                                        
functions directly access the underlying cloud storage and are used to provide                                                                                                                                           
temporary access to data.                                                                                                                                                                                                
The function BUILD_STAGE_FILE_URL simplifies the process of obtaining a URL for data                                                                                                                                     
access and integrates directly within the Snowflake ecosystem, avoiding complex cloud                                                                                                                                    
service configurations. The resulting URL provides a direct path to the specified file                                                                                                                                   
without exposing the details of the underlying storage. This enables users to interact                                                                                                                                   
with their data through a secure, Snowflake-managed file access system.                                                                                                                                                  
Authoritative Links:                                                                                                                                                                                                     
Snowflake Documentation on BUILD_STAGE_FILE_URL:                                                                                                                                                                         
https://docs.snowflake.com/en/sql-reference/functions/build_stage_file_url                                                                                                                                               
Snowflake Documentation on Staging Files: https://docs.snowflake.com/en/userguide/data-load-local-file-system                                                                                                            
</details>                                                                                                                                                                                                               
                                                                                                                                                                                                                         
                                                                                                                                                                                                                         
---                                                                                                                                                                                                                      
Which function will generate a URL that can be accessed by a non-Snowflake user?                                                                                                                                         
                                                                                                                                                                                                                         
A. GET_PRESIGNED_URL<br>B. GET_STAGE_LOCATION<br>C. BUILD_SCOPED_FILE_URL<br>D. BUILD_STAGE_FILE_URL                                                                                                                     
                                                                                                                                                                                                                         
<details>                                                                                                                                                                                                                
<summary><strong>✅ Answer : </strong></summary>                                                                                                                                                                         
<strong>A</strong>                                                                                                                                                                                                       
                                                                                                                                                                                                                         
The Correct answer is ["A"]                                                                                                                                                                                              
</details>                                                                                                                                                                                                               
                                                                                                                                                                                                                         
                                                                                                                                                                                                                         
---                                                                                                                                                                                                                      
Which type of URL gives permanent access to files in cloud storage?                                                                                                                                                      
                                                                                                                                                                                                                         
A. Pre-signed URL<br>B. Account URL<br>C. Scoped URL<br>D. File URL                                                                                                                                                      
                                                                                                                                                                                                                         
<details>                                                                                                                                                                                                                
<summary><strong>✅ Answer : </strong></summary>                                                                                                                                                                         
<strong>D</strong>                                                                                                                                                                                                       
                                                                                                                                                                                                                         
The Correct answer is ["D"]                                                                                                                                                                                              
</details>                                                                                                                                                                                                               
                                                                                                                                                                                                                         
                                                                                                                                                                                                                         
---                                                                                                                                                                                                                      
Which URL identifies the database, schema, stage, and file path to a set of files for accessing the unstructured                                                                                                         
data files in Snowflake?                                                                                                                                                                                                 
                                                                                                                                                                                                                         
A. Scoped URL<br>B. File URL<br>C. Pre-signed URL<br>D. HTTPS URL                                                                                                                                                        
                                                                                                                                                                                                                         
<details>                                                                                                                                                                                                                
<summary><strong>✅ Answer : </strong></summary>                                                                                                                                                                         
<strong>B</strong>                                                                                                                                                                                                       
                                                                                                                                                                                                                         
Here's a detailed justification for why the correct answer is B (File URL) and why the                                                                                                                                   
other options are less suitable when accessing unstructured data files in Snowflake                                                                                                                                      
stages:                                                                                                                                                                                                                  
Snowflake utilizes File URLs to directly reference and access files stored within internal                                                                                                                               
(Snowflake managed) or external stages (e.g., AWS S3, Azure Blob Storage, Google                                                                                                                                         
Cloud Storage). A File URL contains all the necessary location information within                                                                                                                                        
Snowflake, including the database, schema, stage name, and the relative path to the                                                                                                                                      
specific file(s) within that stage. This allows Snowflake to directly pinpoint and retrieve                                                                                                                              
the data from the correct location during operations like querying or loading data from                                                                                                                                  
the stage. The structure of the File URL ensures that Snowflake knows precisely where                                                                                                                                    
to look for the data.                                                                                                                                                                                                    
Let's break down why the other options are not the primary identifiers:                                                                                                                                                  
A. Scoped URL: While the term "scoped URL" might sound relevant in a broader cloud                                                                                                                                       
context to denote limited access permissions, it's not a standard term or concept used                                                                                                                                   
specifically by Snowflake to identify file locations. Scoping often pertains to access                                                                                                                                   
controls, not the primary URL structure.                                                                                                                                                                                 
C. Pre-signed URL: Pre-signed URLs are primarily used for granting temporary, timelimited access to objects in cloud storage services outside of Snowflake. While you could                                              
use a pre-signed URL to first access data in, say, S3 and then load that data into                                                                                                                                       
Snowflake, the pre-signed URL itself is not the identifier Snowflake uses internally to                                                                                                                                  
access the data after it's staged or as a mechanism to access the data from a stage. They                                                                                                                                
are about authentication and authorization prior to staging/accessing the data via                                                                                                                                       
Snowflake's own constructs.                                                                                                                                                                                              
D. HTTPS URL: HTTPS URLs are the general type of URLs used to access resources over                                                                                                                                      
the internet. While an external stage could be backed by an HTTPS endpoint (e.g., an S3                                                                                                                                  
bucket configured for web access), the HTTPS URL itself doesn't provide the context of                                                                                                                                   
the database, schema, stage within Snowflake that is necessary for Snowflake to                                                                                                                                          
correctly manage the file access in a governed manner. The HTTPS URL refers to the                                                                                                                                       
underlying storage, not the Snowflake object representing that storage.                                                                                                                                                  
In summary, Snowflake relies on File URLs to precisely locate unstructured data files                                                                                                                                    
within the database, schema, and stage hierarchy, whether the stage is internal or                                                                                                                                       
external. The other URL types address different aspects of data access or are not                                                                                                                                        
Snowflake-specific terms in this context.                                                                                                                                                                                
Here are resources that will provide more information:                                                                                                                                                                   
Snowflake Stages: https://docs.snowflake.com/en/user-guide/data-load-stages.html                                                                                                                                         
External Tables in Snowflake: https://docs.snowflake.com/en/user-guide/data-externaltables.html                                                                                                                          
</details>                                                                                                                                                                                                               
                                                                                                                                                                                                                         
                                                                                                                                                                                                                         
---                                                                                                                                                                                                                      
Which URL type should be used for custom applications that need to access unstructured data files?                                                                                                                       
                                                                                                                                                                                                                         
                                                                                                                                                                                                                         
A. Scoped URL<br>B. File URL<br>C. Pre-signed URL<br>D. Relative URL                                                                                                                                                     
                                                                                                                                                                                                                         
<details>                                                                                                                                                                                                                
<summary><strong>✅ Answer : </strong></summary>                                                                                                                                                                         
<strong>B</strong>                                                                                                                                                                                                       
                                                                                                                                                                                                                         
The Correct answer is ["B"]                                                                                                                                                                                              
</details>                                                                                                                                                                                                               
                                                                                                                                                                                                                         
                                                                                                                                                                                                                         

# INSERT & UPDATE                                                                                                                                                                                                                                                                                 
Which of the following DML commands isn't supported by Snowflake?                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                                                                  
A. UPSERT<br>B. MERGE<br>C. UPDATE<br>D. TRUNCATE TABLE                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                                                  
<details>                                                                                                                                                                                                                                                                                         
<summary><strong>✅ Answer : </strong></summary>                                                                                                                                                                                                                                                  
<strong>A</strong>                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                  
The correct answer is A, UPSERT. Snowflake natively supports MERGE, UPDATE, and TRUNCATE TABLE as                                                                                                                                                                                                 
DML (Data Manipulation Language) operations. MERGE allows conditional insertion, update, or deletion of                                                                                                                                                                                           
data based on source and target table comparisons, effectively performing upsert-like operations. UPDATE                                                                                                                                                                                          
modifies existing rows within a table based on specified conditions. TRUNCATE TABLE removes all rows from                                                                                                                                                                                         
a table, effectively resetting it, but maintains the table schema. While many databases support a direct                                                                                                                                                                                          
UPSERT operation, Snowflake does not have a specific command named UPSERT. Instead, the desired upsert                                                                                                                                                                                            
functionality is achieved using the MERGE command with appropriate matching criteria and insert/update                                                                                                                                                                                            
clauses. This distinction is crucial for understanding how Snowflake handles data modification. Therefore,                                                                                                                                                                                        
while the outcome of an upsert can be achieved in Snowflake, it isn't through a dedicated "UPSERT" keyword,                                                                                                                                                                                       
making it the correct option among the provided choices.                                                                                                                                                                                                                                          
https://docs.snowflake.com/en/sql-reference/sql/merge.htmlhttps://docs.snowflake.com/en/sqlreference/sql/update.htmlhttps://docs.snowflake.com/en/sql-reference/sql/truncate-table.html                                                                                                           
</details>                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                                                                  
---                                                                                                                                                                                                                                                                                               
Which of the following commands are not blocking operations? (Choose two.)                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                  
A. UPDATE<br>B. INSERT<br>C. MERGE<br>D. COPY                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                                                  
<details>                                                                                                                                                                                                                                                                                         
<summary><strong>✅ Answer : </strong></summary>                                                                                                                                                                                                                                                  
<strong>B, D</strong>                                                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                                                  
The question asks for Snowflake commands that are non-blocking. Non-blocking operations return control to                                                                                                                                                                                         
the user immediately, even if the operation hasn't fully completed. In Snowflake, COPY INTO location                                                                                                                                                                                              
operations with the DETACHED = TRUE parameter and INSERT operations (when using Snowpipe or internal                                                                                                                                                                                              
stages) are generally non-blocking.                                                                                                                                                                                                                                                               
Let's examine why the given options are correct.                                                                                                                                                                                                                                                  
B. INSERT: When using Snowpipe for continuous data loading, INSERT statements are generally nonblocking. Snowpipe automatically ingests data from staged files into Snowflake tables. The initial INSERT                                                                                          
command queues the data for loading, and the command returns control immediately. This allows for                                                                                                                                                                                                 
continuous ingestion without blocking user operations. Additionally, if using internal stages with Auto-Ingest,                                                                                                                                                                                   
INSERT can similarly be considered non-blocking.                                                                                                                                                                                                                                                  
D. COPY: COPY INTO location with the DETACHED = TRUE parameter creates an external stage and initiates                                                                                                                                                                                            
a background operation to copy data into that stage. The command returns immediately, and the data transfer                                                                                                                                                                                       
happens asynchronously. The user does not have to wait for the entire data transfer to complete.                                                                                                                                                                                                  
Now, let's examine why the other options are blocking.                                                                                                                                                                                                                                            
A. UPDATE: UPDATE statements modify existing data within a table. These are generally blocking operations                                                                                                                                                                                         
because Snowflake needs to ensure data consistency and integrity during the update process. The command                                                                                                                                                                                           
waits until the update transaction is fully committed before returning control.C. MERGE: MERGE statements perform a combination of INSERT, UPDATE, and DELETE operations based on                                                                                                                 
a specified condition. Because of this complexity, and the need to maintain data consistency, MERGE                                                                                                                                                                                               
statements are also generally blocking operations. The command waits until all the combined operations are                                                                                                                                                                                        
completed and the transaction committed.                                                                                                                                                                                                                                                          
Therefore, INSERT (when using Snowpipe or internal stages with Auto-Ingest) and COPY INTO location with                                                                                                                                                                                           
DETACHED = TRUE are the non-blocking commands. UPDATE and MERGE are blocking operations because                                                                                                                                                                                                   
they require ensuring data consistency within the Snowflake database.                                                                                                                                                                                                                             
Supporting Documentation:                                                                                                                                                                                                                                                                         
Snowflake COPY command documentation: https://docs.snowflake.com/en/sql-reference/sql/copy-intolocation.html                                                                                                                                                                                      
Snowflake Snowpipe documentation: https://docs.snowflake.com/en/user-guide/data-load-snowpipeintro.html                                                                                                                                                                                           
</details>                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                                                                  
---                                                                                                                                                                                                                                                                                               
True or False: Snowflake enforces unique, primary key, and foreign key constraints during DML operations.                                                                                                                                                                                         
                                                                                                                                                                                                                                                                                                  
A. True<br>B. False                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                  
<details>                                                                                                                                                                                                                                                                                         
<summary><strong>✅ Answer : </strong></summary>                                                                                                                                                                                                                                                  
<strong>B</strong>                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                  
Snowflake does not enforce unique, primary key, or foreign key constraints during Data Manipulation                                                                                                                                                                                               
Language (DML) operations. While you can define these constraints within your table schemas, Snowflake                                                                                                                                                                                            
treats them as informational and descriptive metadata rather than functional constraints. This means that you                                                                                                                                                                                     
can insert, update, or delete data that violates these defined constraints without encountering any errors or                                                                                                                                                                                     
rejections from Snowflake. This behavior is primarily due to Snowflake's architecture being optimized for                                                                                                                                                                                         
analytical workloads, which often prioritize data ingestion speed and flexibility over strict referential integrity                                                                                                                                                                               
checks during loading. Snowflake assumes data validation and cleansing happens prior to loading, often                                                                                                                                                                                            
within the data integration pipeline. The database engine focuses on storing and querying the data efficiently,                                                                                                                                                                                   
not on enforcing operational integrity at the database layer. This design choice allows for parallel data                                                                                                                                                                                         
loading and enables Snowflake to scale more effectively for large datasets. If strict enforcement is required,                                                                                                                                                                                    
it should be handled through alternative mechanisms such as pre-processing scripts or by utilizing stored                                                                                                                                                                                         
procedures to trigger actions based on constraint violations.                                                                                                                                                                                                                                     
Authoritative Links:                                                                                                                                                                                                                                                                              
Snowflake Documentation on Constraints: https://docs.snowflake.com/en/sql-reference/constraintsoverview (Specifically highlights that they are not enforced).                                                                                                                                     
Blog Post on Snowflake Constraint Handling: https://www.snowflake.com/blog/declarative-constraints-forsnowflake/ (Explains the informational nature of constraints).                                                                                                                              
</details>                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                                                                  
---                                                                                                                                                                                                                                                                                               
Which operation will produce an error in Snowflake?                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                  
A. Inserting duplicate values into a PRIMARY KEY column<br>B. Inserting a NULL into a column with a NOT NULL constraint<br>C. Inserting duplicate values into a column with a UNIQUE constraint<br>D. Inserting a value to FOREIGN KEY column that does not match a value in the column referenced
                                                                                                                                                                                                                                                                                                  
<details>                                                                                                                                                                                                                                                                                         
<summary><strong>✅ Answer : </strong></summary>                                                                                                                                                                                                                                                  
<strong>B</strong>                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                  
The correct answer is B. Inserting a NULL into a column with a NOT NULL constraint. This operation will                                                                                                                                                                                           
indeed produce an error in Snowflake, and most other relational database systems.                                                                                                                                                                                                                 
A NOT NULL constraint on a column explicitly disallows the insertion or updating of a row that has a NULL                                                                                                                                                                                         
value in that particular column. This is a fundamental concept in database integrity, ensuring data                                                                                                                                                                                               
completeness and preventing null values from being introduced where they are not valid or meaningful. When                                                                                                                                                                                        
attempting to insert or update with a NULL value in such a column, the database system raises a constraint                                                                                                                                                                                        
violation error, stopping the operation and preventing inconsistent data.                                                                                                                                                                                                                         
Options A, C, and D, while related to constraints, behave differently. Primary key and unique constraints                                                                                                                                                                                         
enforce uniqueness, and inserting duplicate values in those contexts will produce errors. However, the                                                                                                                                                                                            
question specifically asks for the operation that will produce an error. Inserting duplicate values will violate                                                                                                                                                                                  
constraints, but the correct answer is B because the question is about NULL insertion into a not null column.                                                                                                                                                                                     
Foreign keys establish relationships between tables; inserting values that do not match the referenced table                                                                                                                                                                                      
is a constraint violation.                                                                                                                                                                                                                                                                        
In summary, while multiple constraints can cause errors, only inserting a NULL into a NOT NULL column will                                                                                                                                                                                        
directly produce an error related to the not null constraint, making option B the only operation described that                                                                                                                                                                                   
does this.                                                                                                                                                                                                                                                                                        
Here are some relevant authoritative links:                                                                                                                                                                                                                                                       
Snowflake Documentation on Constraints: https://docs.snowflake.com/en/sql-reference/constraintsoverview                                                                                                                                                                                           
SQL NOT NULL Constraint Explanation: https://www.w3schools.com/sql/sql_notnull.asp                                                                                                                                                                                                                
Database Constraints: https://www.geeksforgeeks.org/dbms-constraints/                                                                                                                                                                                                                             
</details>                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                                                                  
---                                                                                                                                                                                                                                                                                               
Which SQL statement will require a virtual warehouse to run?                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                                                                  
A. SELECT COUNT(*) FROM TBL_EMPLOYEE;<br>B. ALTER TABLE TBL_EMPLOYEE ADD COLUMN EMP_REGION VARCHAR(20);<br>C. INSERT INTO TBL_EMPLOYEE(EMP_ID, EMP_NAME, EMP_SALARY, DEPT) VALUES(1, 'Adam', 20000,<br>D. CREATE OR REPLACE TABLE TBL_EMPLOYEE                                                    
                                                                                                                                                                                                                                                                                                  
<details>                                                                                                                                                                                                                                                                                         
<summary><strong>✅ Answer : </strong></summary>                                                                                                                                                                                                                                                  
<strong>C</strong>                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                  
The correct answer is C. INSERT INTO TBL_EMPLOYEE(EMP_ID, EMP_NAME, EMP_SALARY, DEPT)                                                                                                                                                                                                             
VALUES(1, 'Adam', 20000, 'Finance’); This statement requires a virtual warehouse in Snowflake because it                                                                                                                                                                                          
involves data manipulation (specifically, writing data).                                                                                                                                                                                                                                          
Here's a breakdown:                                                                                                                                                                                                                                                                               
Snowflake separates compute resources (virtual warehouses) from storage. SQL operations that modify or                                                                                                                                                                                            
process data, such as inserting, updating, or deleting rows, necessitate compute power provided by a running                                                                                                                                                                                      
virtual warehouse. Without an active warehouse, these operations cannot be executed.                                                                                                                                                                                                              
Option A, SELECT COUNT(*) FROM TBL_EMPLOYEE;, is a query that reads data but doesn't modify it. While it                                                                                                                                                                                          
uses compute, Snowflake’s query optimization often handles basic read queries without explicitly requiring a                                                                                                                                                                                      
warehouse for simple metadata operations. Option B, ALTER TABLE TBL_EMPLOYEE ADD COLUMN                                                                                                                                                                                                           
EMP_REGION VARCHAR(20);, is a DDL (Data Definition Language) statement and typically doesn’t need an                                                                                                                                                                                              
active virtual warehouse as it only changes the structure of the table’s metadata. Option D, CREATE OR                                                                                                                                                                                            
REPLACE TABLE TBL_EMPLOYEE(EMP_ID NUMBER,EMP_NAME VARCHAR(30),EMP_SALARY                                                                                                                                                                                                                          
NUMBER,DEPT VARCHAR(20));, like option B, is also a DDL statement and operates primarily on metadata,                                                                                                                                                                                             
not requiring an active virtual warehouse in a typical Snowflake setup.                                                                                                                                                                                                                           
In contrast, the INSERT statement actively writes new data to the table. This process demands the                                                                                                                                                                                                 
computational capabilities of a virtual warehouse to manage data insertion and associated operations.                                                                                                                                                                                             
Therefore, it is the only SQL operation listed that explicitly requires an active virtual warehouse.                                                                                                                                                                                              
In summary, data manipulation language (DML) statements like INSERT must have a virtual warehouse to                                                                                                                                                                                              
execute, whereas Data Definition Language (DDL) statements and basic read queries might not always require                                                                                                                                                                                        
one. The distinction between metadata and data manipulation dictates warehouse usage.                                                                                                                                                                                                             
Further Reading:                                                                                                                                                                                                                                                                                  
Snowflake Documentation on Virtual Warehouses: https://docs.snowflake.com/en/user-guide/warehouses                                                                                                                                                                                                
Snowflake Documentation on Data Loading: https://docs.snowflake.com/en/user-guide/data-load                                                                                                                                                                                                       
Snowflake Documentation on SQL Statements: https://docs.snowflake.com/en/sql-reference/sql                                                                                                                                                                                                        
</details>                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                                                                  

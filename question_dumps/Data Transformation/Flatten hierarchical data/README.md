# Flatten hierarchical data                                                                                                                                                                                                                                                                                                                                                          
The FLATTEN function is used to query which type of data in Snowflake?                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                     
A. Structured data<br>B. Semi-structured data<br>C. Both of the above<br>D. None of the above                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                     
<details>                                                                                                                                                                                                                                                                                                                                                                            
<summary><strong>âœ… Answer : </strong></summary>                                                                                                                                                                                                                                                                                                                                     
<strong>C</strong>                                                                                                                                                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                                                                                                                                                     
The correct answer is C, "Both of the above." The FLATTEN function in Snowflake is explicitly designed to                                                                                                                                                                                                                                                                            
handle semi-structured data, but it can also be effectively used in conjunction with structured data for certain                                                                                                                                                                                                                                                                     
transformations and manipulations.                                                                                                                                                                                                                                                                                                                                                   
FLATTEN's primary purpose is to expand arrays and objects contained within semi-structured data formats                                                                                                                                                                                                                                                                              
like JSON, Avro, ORC, Parquet, and XML into a relational form, making it easier to query. It iterates through the                                                                                                                                                                                                                                                                    
elements within a variant column, creating a new row for each element. This is essential because querying                                                                                                                                                                                                                                                                            
nested data without flattening would be significantly more complex and less efficient.                                                                                                                                                                                                                                                                                               
However, FLATTEN can also be applied to structured data scenarios, especially when working with array-like                                                                                                                                                                                                                                                                           
structures within relational tables. Imagine a scenario where a column in a structured table contains a                                                                                                                                                                                                                                                                              
comma-separated list or an array-like string. FLATTEN, along with functions like SPLIT_TO_TABLE, can be                                                                                                                                                                                                                                                                              
utilized to deconstruct this data into multiple rows, effectively transforming structured data into a format that                                                                                                                                                                                                                                                                    
can be analyzed more granularly. While not its core function, it extends the analytical capabilities when                                                                                                                                                                                                                                                                            
dealing with list-like data in relational databases.                                                                                                                                                                                                                                                                                                                                 
Therefore, while FLATTEN is most commonly associated with and fundamentally designed for semistructured data, its utility extends to structured data when data transformations involving array-like or listlike representations within columns are required. Hence, the ability to process both structured and semistructured data makes option C the most accurate.                 
References:                                                                                                                                                                                                                                                                                                                                                                          
Snowflake FLATTEN function: https://docs.snowflake.com/en/sql-reference/functions/flatten.html                                                                                                                                                                                                                                                                                       
</details>                                                                                                                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                                                                                                                                     
---                                                                                                                                                                                                                                                                                                                                                                                  
Which columns are part of the result set of the Snowflake LATERAL FLATTEN command? (Choose two.)                                                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                                                                                                                                     
A. CONTENT<br>B. PATH<br>C. BYTE_SIZE<br>D. INDEX<br>E. DATATYPE                                                                                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                                                                                                                                     
<details>                                                                                                                                                                                                                                                                                                                                                                            
<summary><strong>âœ… Answer : </strong></summary>                                                                                                                                                                                                                                                                                                                                     
<strong>B, D</strong>                                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                     
The correct answer, B (PATH) and D (INDEX), accurately identifies two key columns returned by Snowflake's                                                                                                                                                                                                                                                                            
LATERAL FLATTEN command. LATERAL FLATTEN is a table function used to expand semi-structured data,                                                                                                                                                                                                                                                                                    
such as JSON or arrays, into a relational format. The PATH column reflects the location within the semistructured data where the current element was extracted. This can be a key within a JSON object or an array                                                                                                                                                                   
index. The INDEX column, pertinent to arrays, indicates the numerical position of the element within the array.                                                                                                                                                                                                                                                                      
Options A (CONTENT) and C (BYTE_SIZE) are not standard outputs of LATERAL FLATTEN. While the value                                                                                                                                                                                                                                                                                   
extracted from the semi-structured data is returned as a column (usually named "value" by default but this                                                                                                                                                                                                                                                                           
name can be changed using the as clause), CONTENT is not the name of a default column returned. The size                                                                                                                                                                                                                                                                             
of the data in bytes isn't explicitly provided as a column. Similarly, Option E (DATATYPE) is not part of the                                                                                                                                                                                                                                                                        
direct output columns of the function. Snowflake does infer and store the datatype internally, but does not                                                                                                                                                                                                                                                                          
surface it as an explicit output column from LATERAL FLATTEN.                                                                                                                                                                                                                                                                                                                        
Essentially, the returned value and its location are essential for understanding the structure after flattening.                                                                                                                                                                                                                                                                     
The PATH and INDEX columns are crucial for reassembling or navigating through the original semi-structured                                                                                                                                                                                                                                                                           
data if needed. For instance, to know that "value1" came from the JSON object key "person.address.street"                                                                                                                                                                                                                                                                            
and is the third element in an array nested under that, you'd consult the PATH and INDEX columns                                                                                                                                                                                                                                                                                     
respectively. The function simplifies querying semi-structured data, enabling users to treat it similar to                                                                                                                                                                                                                                                                           
relational tables, which is a core feature for data analysis in cloud environments.                                                                                                                                                                                                                                                                                                  
For further exploration, refer to the official Snowflake documentation:                                                                                                                                                                                                                                                                                                              
LATERAL FLATTEN Function: Provides comprehensive details on its syntax, usage, and returned columns.                                                                                                                                                                                                                                                                                 
</details>                                                                                                                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                                                                                                                                     
---                                                                                                                                                                                                                                                                                                                                                                                  
Which TABLE function helps to convert semi-structured data to a relational representation?                                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                                                                                                                                     
A. CHECK_JSON<br>B. TO_JSON<br>C. FLATTEN<br>D. PARSE_JSON                                                                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                                                                                                                                     
<details>                                                                                                                                                                                                                                                                                                                                                                            
<summary><strong>âœ… Answer : </strong></summary>                                                                                                                                                                                                                                                                                                                                     
<strong>C</strong>                                                                                                                                                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                                                                                                                                                     
The correct answer is C. FLATTEN. The FLATTEN table function in Snowflake is explicitly designed to convert                                                                                                                                                                                                                                                                          
semi-structured data, such as JSON, Avro, or Parquet, into a relational format suitable for querying with SQL.                                                                                                                                                                                                                                                                       
It achieves this by "exploding" the nested structures within the semi-structured data into separate rows. Each                                                                                                                                                                                                                                                                       
resulting row represents a flattened element from the input data, typically including columns for the key,                                                                                                                                                                                                                                                                           
index (for arrays), and the value of the element. This process effectively transforms data that's not inherently                                                                                                                                                                                                                                                                     
tabular into a tabular representation, enabling joins, filters, and other relational operations.                                                                                                                                                                                                                                                                                     
CHECK_JSONB and PARSE_JSON are not table functions and serve different purposes. PARSE_JSON is a                                                                                                                                                                                                                                                                                     
scalar function that parses a JSON string into a variant data type; it doesn't convert it into a relational format.                                                                                                                                                                                                                                                                  
Similarly, CHECK_JSONB isn't a standard Snowflake function, though a user defined function could have this                                                                                                                                                                                                                                                                           
name. The primary use case of FLATTEN is breaking down nested data structures, making it ideal for                                                                                                                                                                                                                                                                                   
analyzing data from diverse sources with varying levels of nesting. By using FLATTEN on a column holding                                                                                                                                                                                                                                                                             
semi-structured data, the output is presented as a temporary relation, which can then be incorporated into                                                                                                                                                                                                                                                                           
views or tables, or utilized in further queries. This is essential for seamless analysis of semi-structured data                                                                                                                                                                                                                                                                     
within the relational framework of Snowflake.                                                                                                                                                                                                                                                                                                                                        
For further information on the FLATTEN table function, refer to the official Snowflake documentation:                                                                                                                                                                                                                                                                                
https://docs.snowflake.com/en/sql-reference/functions/flatten                                                                                                                                                                                                                                                                                                                        
</details>                                                                                                                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                                                                                                                                     
---                                                                                                                                                                                                                                                                                                                                                                                  
What columns are returned when performing a FLATTEN command on semi-structured data? (Choose two.)                                                                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                                                                                                                                     
A. KEY<br>B. NODE<br>C. VALUE<br>D. LEVEL<br>E. ROOT                                                                                                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                                                                                                                                                     
<details>                                                                                                                                                                                                                                                                                                                                                                            
<summary><strong>âœ… Answer : </strong></summary>                                                                                                                                                                                                                                                                                                                                     
<strong>A, C</strong>                                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                     
The FLATTEN function in Snowflake is designed to explode complex semi-structured data, such as JSON or                                                                                                                                                                                                                                                                               
arrays, into relational rows. When you apply FLATTEN, it doesn't just provide the raw data; instead, it gives you                                                                                                                                                                                                                                                                    
a structured representation of the data's hierarchical elements. The primary columns returned are KEY and                                                                                                                                                                                                                                                                            
VALUE. The KEY column indicates the key within the current level of the semi-structured data being                                                                                                                                                                                                                                                                                   
flattened. For a JSON object, this would be the field name. For an array, it is the index of each element starting                                                                                                                                                                                                                                                                   
at zero. The VALUE column contains the actual value associated with that particular key or index. It could be a                                                                                                                                                                                                                                                                      
simple scalar value like a string, number, or a nested JSON object or array. The NODE, LEVEL, and ROOT                                                                                                                                                                                                                                                                               
columns are not directly returned by the FLATTEN function itself. While these concepts relate to the data                                                                                                                                                                                                                                                                            
structure, FLATTEN mainly exposes the key-value pairs at the targeted flattening level. It is important tounderstand that FLATTEN generates a set of rows, each reflecting a single level of the hierarchical data,                                                                                                                                                                  
where the KEY identifies the path to access the VALUE. By utilizing these returned columns, you can then                                                                                                                                                                                                                                                                             
manipulate and query the formerly nested elements as relational data.                                                                                                                                                                                                                                                                                                                
For more details on the FLATTEN function and its syntax, you can refer to the official Snowflake                                                                                                                                                                                                                                                                                     
documentation: https://docs.snowflake.com/en/sql-reference/functions/flatten.html                                                                                                                                                                                                                                                                                                    
</details>                                                                                                                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                                                                                                                                     
---                                                                                                                                                                                                                                                                                                                                                                                  
Which function produces a lateral view of a VARIANT column?                                                                                                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                                                                                                                                                     
A. GET_PATH<br>B. FLATTEN<br>C. GET<br>D. PARSE_JSON                                                                                                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                                                                                                                                                     
<details>                                                                                                                                                                                                                                                                                                                                                                            
<summary><strong>âœ… Answer : </strong></summary>                                                                                                                                                                                                                                                                                                                                     
<strong>B</strong>                                                                                                                                                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                                                                                                                                                     
The correct answer is B. FLATTEN. The FLATTEN function in Snowflake is specifically designed to produce a                                                                                                                                                                                                                                                                            
lateral view of complex data structures like VARIANT columns, which often store semi-structured data such                                                                                                                                                                                                                                                                            
as JSON or arrays. FLATTEN transforms a single row containing a complex element into multiple rows,                                                                                                                                                                                                                                                                                  
effectively unnesting the structure. This makes it easier to work with the individual elements within the                                                                                                                                                                                                                                                                            
VARIANT data. The LATERAL aspect of the view means that the output of FLATTEN is applied row-by-row,                                                                                                                                                                                                                                                                                 
allowing access to fields within the VARIANT for each original row. In contrast, GET_PATH (A) retrieves values                                                                                                                                                                                                                                                                       
from specific paths within a VARIANT, but does not expand rows. GET (C) is a more general function for                                                                                                                                                                                                                                                                               
extracting data, but is not designed for lateral expansion and typically works on a single key. PARSE_JSON                                                                                                                                                                                                                                                                           
(D) parses a string into a JSON VARIANT but doesn't perform lateral unnesting. Therefore, FLATTEN is the                                                                                                                                                                                                                                                                             
only function that fits the requirements of generating a lateral view from a VARIANT column, effectively                                                                                                                                                                                                                                                                             
turning a single complex record into multiple related records which is necessary for analysis and reporting.                                                                                                                                                                                                                                                                         
For further details, refer to Snowflakeâ€™s official documentation on the FLATTEN function:                                                                                                                                                                                                                                                                                            
https://docs.snowflake.com/en/sql-reference/functions/flatten                                                                                                                                                                                                                                                                                                                        
</details>                                                                                                                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                                                                                                                                     
---                                                                                                                                                                                                                                                                                                                                                                                  
Which function will return a row for each for each object in a VARIANT, OBJECT, or ARRAY column?                                                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                                                                                                                                     
A. CAST<br>B. FLATTEN<br>C. GET<br>D. PARSE_JSON                                                                                                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                                                                                                                                     
<details>                                                                                                                                                                                                                                                                                                                                                                            
<summary><strong>âœ… Answer : </strong></summary>                                                                                                                                                                                                                                                                                                                                     
<strong>B</strong>                                                                                                                                                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                                                                                                                                                     
The correct answer is B. FLATTEN. The FLATTEN function in Snowflake is specifically designed to expand                                                                                                                                                                                                                                                                               
semi-structured data, such as VARIANT, OBJECT, or ARRAY columns, into a relational, row-based format. This                                                                                                                                                                                                                                                                           
operation is crucial for querying nested data structures effectively. FLATTEN essentially creates a separate                                                                                                                                                                                                                                                                         
row for each element within the input structure. This transforms complex, hierarchical data into a tabular                                                                                                                                                                                                                                                                           
structure that standard SQL can easily process. This process is necessary when extracting individual values                                                                                                                                                                                                                                                                          
from arrays or objects for analysis.                                                                                                                                                                                                                                                                                                                                                 
CAST (option A) is used for type conversions between different data types, not for expanding nested                                                                                                                                                                                                                                                                                  
structures. GET (option C) retrieves a single element from a VARIANT or OBJECT using a specified key or                                                                                                                                                                                                                                                                              
index, but it does not produce a row for each element in the structure. PARSE_JSON (option D) converts a                                                                                                                                                                                                                                                                             
string into a JSON document (VARIANT), it does not expand it into rows.                                                                                                                                                                                                                                                                                                              
Therefore, only FLATTEN is capable of achieving the task of generating a new row for each object within a                                                                                                                                                                                                                                                                            
VARIANT, OBJECT, or ARRAY column, making it the correct choice for the described scenario. It facilitates the                                                                                                                                                                                                                                                                        
analysis and manipulation of semi-structured data within a relational database environment.                                                                                                                                                                                                                                                                                          
For more details on Snowflakeâ€™s FLATTEN function and its usage, refer to the official Snowflake                                                                                                                                                                                                                                                                                      
documentation:                                                                                                                                                                                                                                                                                                                                                                       
Snowflake FLATTEN Documentation                                                                                                                                                                                                                                                                                                                                                      
</details>                                                                                                                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                                                                                                                                     
---                                                                                                                                                                                                                                                                                                                                                                                  
A JSON file that contains lots of dates and arrays needs to be processed in Snowflake. The user wants to ensure                                                                                                                                                                                                                                                                      
optimal performance while querying the data.                                                                                                                                                                                                                                                                                                                                         
How can this be achieved?                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                     
A. Flatten the data and store it in structured data types in a flattened table. Query the table.<br>B. Store the data in a table with a VARIANT data type. Query the table.<br>C. Store the data in a table with a VARIANT data type and include STRIP_NULL_VALUES while loading the table.<br>D. Store the data in an external stage and create views on top of it. Query the views.
                                                                                                                                                                                                                                                                                                                                                                                     
<details>                                                                                                                                                                                                                                                                                                                                                                            
<summary><strong>âœ… Answer : </strong></summary>                                                                                                                                                                                                                                                                                                                                     
<strong>A</strong>                                                                                                                                                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                                                                                                                                                     
The optimal approach for querying JSON data containing dates and arrays in Snowflake, focusing on                                                                                                                                                                                                                                                                                    
performance, is to flatten the data into a structured table using appropriate data types (Option A). While                                                                                                                                                                                                                                                                           
Snowflake's VARIANT data type (Options B and C) is flexible and can store semi-structured data, it incurs a                                                                                                                                                                                                                                                                          
performance penalty when querying due to the need for runtime parsing and type inference. Flattening                                                                                                                                                                                                                                                                                 
involves extracting the nested elements and storing them in separate columns with specific data types like                                                                                                                                                                                                                                                                           
DATE, INTEGER, or BOOLEAN, enabling Snowflake's query engine to leverage indexing, partitioning, and                                                                                                                                                                                                                                                                                 
other optimizations. Option C introduces STRIP_NULL_VALUES, which is primarily for storage efficiency, not                                                                                                                                                                                                                                                                           
query performance optimization. Option D, using external stages and views, adds an extra layer of abstraction                                                                                                                                                                                                                                                                        
that doesn't address the core need for optimal query performance; it's better for accessing data without                                                                                                                                                                                                                                                                             
transformations. Flattening also avoids the cost of repeatedly parsing VARIANT columns, especially when                                                                                                                                                                                                                                                                              
dealing with large datasets and frequent queries. By pre-structuring the data, the query engine can directly                                                                                                                                                                                                                                                                         
access the required values, leading to significantly faster query execution and reduced resource                                                                                                                                                                                                                                                                                     
consumption. This approach is particularly beneficial for large datasets with many dates and arrays.                                                                                                                                                                                                                                                                                 
Authoritative Links:                                                                                                                                                                                                                                                                                                                                                                 
Snowflake Documentation on Data Types: https://docs.snowflake.com/en/sql-reference/data-types.html                                                                                                                                                                                                                                                                                   
Snowflake Documentation on Working with Semi-structured Data: https://docs.snowflake.com/en/guidesoverview-semistructured-data.html                                                                                                                                                                                                                                                  
Snowflake Performance Optimization Best Practices: https://docs.snowflake.com/en/userguide/performance-best-practices.html                                                                                                                                                                                                                                                           
</details>                                                                                                                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                                                                                                                                     
---                                                                                                                                                                                                                                                                                                                                                                                  
What does the LATERAL modifier for the FLATTEN function do?                                                                                                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                                                                                                                                                     
A. Casts the values of the flattened data<br>B. Extracts the path of the flattened data<br>C. Joins information outside the object with the flattened data<br>D. Retrieves a single instance of a repeating element in the flattened data                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                     
<details>                                                                                                                                                                                                                                                                                                                                                                            
<summary><strong>âœ… Answer : </strong></summary>                                                                                                                                                                                                                                                                                                                                     
<strong>C</strong>                                                                                                                                                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                                                                                                                                                     
The correct answer is C. Joins information outside the object with the flattened data.                                                                                                                                                                                                                                                                                               
The LATERAL modifier, when used with the FLATTEN function in Snowflake, doesn't directly cast                                                                                                                                                                                                                                                                                        
data types, extract paths, or retrieve single instances of repeating elements within the flattenedstructure. Its primary purpose is to enable a correlated subquery-like behavior during the                                                                                                                                                                                         
flattening process.                                                                                                                                                                                                                                                                                                                                                                  
Specifically, without LATERAL, FLATTEN operates on a single row of the input table, generating                                                                                                                                                                                                                                                                                       
flattened rows based on the array or object within that row. However, with LATERAL, the output                                                                                                                                                                                                                                                                                       
of the FLATTEN function for each row is combined with the other columns of the original row. This                                                                                                                                                                                                                                                                                    
allows you to join the flattened data with other data from the same or different tables based on a                                                                                                                                                                                                                                                                                   
common key or other relationship. It allows you to work on each element of a nested object/array                                                                                                                                                                                                                                                                                     
and join the resulting rows with the rest of the rowâ€™s information. Think of it as a way to create a                                                                                                                                                                                                                                                                                 
result set where each flattened element is aware of the context of the original row from which it                                                                                                                                                                                                                                                                                    
was extracted. Essentially, LATERAL effectively allows for a row-by-row join, linking data                                                                                                                                                                                                                                                                                           
obtained from the flattened array or object to the associated row from the base table. This                                                                                                                                                                                                                                                                                          
empowers users to perform more complex queries involving both structured and semi-structured                                                                                                                                                                                                                                                                                         
data within Snowflake. The absence of LATERAL makes this kind of correlated operation                                                                                                                                                                                                                                                                                                
significantly more challenging to implement.                                                                                                                                                                                                                                                                                                                                         
For a comprehensive understanding, refer to the official Snowflake documentation on the                                                                                                                                                                                                                                                                                              
FLATTEN function and the LATERAL keyword: https://docs.snowflake.com/en/sqlreference/functions/flatten and https://docs.snowflake.com/en/sql-reference/constructs/lateral.                                                                                                                                                                                                           
</details>                                                                                                                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                                                                                                                                     
---                                                                                                                                                                                                                                                                                                                                                                                  
What function can be used with the recursive argument to return a list of distinct key names in all nested elements                                                                                                                                                                                                                                                                  
in an object?                                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                     
A. FLATTEN<br>B. GET_PATH<br>C. CHECK_JSON<br>D. PARSE_JSON                                                                                                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                                                                                                                                                     
<details>                                                                                                                                                                                                                                                                                                                                                                            
<summary><strong>âœ… Answer : </strong></summary>                                                                                                                                                                                                                                                                                                                                     
<strong>A</strong>                                                                                                                                                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                                                                                                                                                     
The correct answer is A, FLATTEN. The FLATTEN function in Snowflake is specifically                                                                                                                                                                                                                                                                                                  
designed to unpack nested structures like objects and arrays, making it ideal for                                                                                                                                                                                                                                                                                                    
extracting key names from complex JSON data. When used with the RECURSIVE                                                                                                                                                                                                                                                                                                            
argument, FLATTEN traverses all levels of nesting within the object. Crucially, FLATTEN                                                                                                                                                                                                                                                                                              
produces a table-like output with columns containing key-value pairs and other                                                                                                                                                                                                                                                                                                       
positional information, allowing the key names to be extracted using KEY column. No                                                                                                                                                                                                                                                                                                  
other function is purpose-built to operate this way for nested data. GET_PATH retrieves                                                                                                                                                                                                                                                                                              
values at a specific path but is not designed to discover all keys. CHECK_JSON and                                                                                                                                                                                                                                                                                                   
PARSE_JSON are for validating and transforming JSON, respectively, but not for the                                                                                                                                                                                                                                                                                                   
type of recursive key extraction required. Therefore, FLATTEN with the recursive option                                                                                                                                                                                                                                                                                              
is the most appropriate and efficient choice for this task. Specifically, when FLATTEN is                                                                                                                                                                                                                                                                                            
used with RECURSIVE => TRUE and applied to a JSON object containing potentially                                                                                                                                                                                                                                                                                                      
nested objects or arrays, it will return a table with a row for each individual value found,                                                                                                                                                                                                                                                                                         
making it feasible to list all distinct key names by selecting the distinct values within the                                                                                                                                                                                                                                                                                        
'key' column.                                                                                                                                                                                                                                                                                                                                                                        
For further research on the Snowflake FLATTEN function and its capabilities, refer to the                                                                                                                                                                                                                                                                                            
official Snowflake documentation: https://docs.snowflake.com/en/sqlreference/functions/flatten                                                                                                                                                                                                                                                                                       
</details>                                                                                                                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                                                                                                                                     
---                                                                                                                                                                                                                                                                                                                                                                                  
Which function can be used to convert semi-structured data into rows and columns?                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                     
A. TABLE<br>B. FLATTEN<br>C. PARSE_JSON<br>D. JSON_EXTRACT_PATH_TEXT                                                                                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                                                                                                                                                     
<details>                                                                                                                                                                                                                                                                                                                                                                            
<summary><strong>âœ… Answer : </strong></summary>                                                                                                                                                                                                                                                                                                                                     
<strong>B</strong>                                                                                                                                                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                                                                                                                                                     
The correct answer is B. FLATTEN.                                                                                                                                                                                                                                                                                                                                                    
The FLATTEN function in Snowflake is specifically designed to transform semistructured data, such as JSON or arrays, into a relational format by producing a lateral                                                                                                                                                                                                                 
view. This means it takes a single row with complex data and outputs multiple rows,                                                                                                                                                                                                                                                                                                  
effectively "flattening" the structure. Each resulting row typically represents a                                                                                                                                                                                                                                                                                                    
component within the original semi-structured element, like elements in an array or keyvalue pairs in a JSON object.                                                                                                                                                                                                                                                                 
Option A, TABLE, is used for querying and manipulating existing tables, not for                                                                                                                                                                                                                                                                                                      
transforming semi-structured data. Option C, PARSE_JSON, converts a text string                                                                                                                                                                                                                                                                                                      
representing JSON into a JSON object, making it usable within Snowflake, but it doesn't                                                                                                                                                                                                                                                                                              
restructure the data into rows and columns. Option D, JSON_EXTRACT_PATH_TEXT,                                                                                                                                                                                                                                                                                                        
extracts a value from a specific path in a JSON object, but again, it doesnâ€™t flatten the                                                                                                                                                                                                                                                                                            
structure into multiple rows.                                                                                                                                                                                                                                                                                                                                                        
Therefore, only FLATTEN directly facilitates the desired conversion from semistructured formats to the structured row-and-column format that relational databases                                                                                                                                                                                                                    
utilize. The output of flatten is used in a from clause to enable users to query the newly                                                                                                                                                                                                                                                                                           
generated rows. Using the provided sample JSON, FLATTEN would create rows for each                                                                                                                                                                                                                                                                                                   
nested value, such as "voted_answers", "vote_count", and "is_most_voted", allowing                                                                                                                                                                                                                                                                                                   
users to access these elements as columns. This makes it the appropriate choice for                                                                                                                                                                                                                                                                                                  
analyzing data stored in semi-structured formats within Snowflake. It essentially                                                                                                                                                                                                                                                                                                    
exposes each field in the nested JSON as a column within the lateral view result.                                                                                                                                                                                                                                                                                                    
For further reading and confirmation, refer to Snowflakeâ€™s official documentation on the                                                                                                                                                                                                                                                                                             
FLATTEN function: https://docs.snowflake.com/en/sql-reference/functions/flatten and                                                                                                                                                                                                                                                                                                  
Semi-structured data documentation https://docs.snowflake.com/en/sqlreference/data-types-semi-structured                                                                                                                                                                                                                                                                             
</details>                                                                                                                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                                                                                                                                     
---                                                                                                                                                                                                                                                                                                                                                                                  
Which function will convert semi-structured data to a relational data representation?                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                     
A. PARSE_JSON<br>B. FLATTEN<br>C. OBJECT_CONSTRUCT<br>D. OBJECT_AGG                                                                                                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                                                                                                                                                     
<details>                                                                                                                                                                                                                                                                                                                                                                            
<summary><strong>âœ… Answer : </strong></summary>                                                                                                                                                                                                                                                                                                                                     
<strong>B</strong>                                                                                                                                                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                                                                                                                                                     
The Correct answer is ["B"]                                                                                                                                                                                                                                                                                                                                                          
</details>                                                                                                                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                                                                                                                                     

# Load semi-structured data                                                                                                                                                                                                                                                                                                                                                                                                      
What file formats does Snowflake support for loading semi-structured data? (Choose three.)                                                                                                                                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                                                                                                                                                                                                 
A. TSV<br>B. JSON<br>C. PDF<br>D. Avro<br>E. Parquet<br>F. JPEG                                                                                                                                                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                                                                                                                                                                                                 
<details>                                                                                                                                                                                                                                                                                                                                                                                                                        
<summary><strong>âœ… Answer : </strong></summary>                                                                                                                                                                                                                                                                                                                                                                                 
<strong>B, D, E</strong>                                                                                                                                                                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                                                                                                                                                                                                 
The correct answer is B, D, and E: JSON, Avro, and Parquet. These are file formats that Snowflake natively                                                                                                                                                                                                                                                                                                                       
supports for loading semi-structured data. JSON (JavaScript Object Notation) is a widely used, humanreadable text-based format for representing data objects, making it ideal for handling nested structures. Avro                                                                                                                                                                                                               
is a row-oriented data serialization framework often used in Apache Hadoop, offering efficient data                                                                                                                                                                                                                                                                                                                              
compression and schema evolution capabilities. Parquet, also columnar in nature, excels at storage efficiency                                                                                                                                                                                                                                                                                                                    
and fast query performance, especially suitable for analytical workloads. Snowflake's ability to ingest these                                                                                                                                                                                                                                                                                                                    
formats directly allows for simplified data loading without complex transformations. Formats like TSV (Tab                                                                                                                                                                                                                                                                                                                       
Separated Values), PDF, and JPEG are not designed for storing or querying semi-structured data. TSV is                                                                                                                                                                                                                                                                                                                           
suitable for tabular data, PDF for documents, and JPEG for images, requiring preprocessing if incorporated                                                                                                                                                                                                                                                                                                                       
into a data pipeline. Snowflake's documentation explicitly lists JSON, Avro, and Parquet as the main                                                                                                                                                                                                                                                                                                                             
supported formats for semi-structured data ingestion.                                                                                                                                                                                                                                                                                                                                                                            
https://docs.snowflake.com/en/sql-reference/data-types-semistructuredhttps://docs.snowflake.com/en/userguide/data-load-considerations                                                                                                                                                                                                                                                                                            
</details>                                                                                                                                                                                                                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                                                                                                                                                                                                 
---                                                                                                                                                                                                                                                                                                                                                                                                                              
Which semi-structured data formats can be loaded into Snowflake with a COPY command? (Choose two.)                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                 
A. CSV<br>B. EDI<br>C. HTML<br>D. ORC<br>E. XML                                                                                                                                                                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                                                                                                                                                                                                 
<details>                                                                                                                                                                                                                                                                                                                                                                                                                        
<summary><strong>âœ… Answer : </strong></summary>                                                                                                                                                                                                                                                                                                                                                                                 
<strong>D, E</strong>                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                 
The correct answer is D. ORC and E. XML. Snowflake's COPY command is designed to load data from various                                                                                                                                                                                                                                                                                                                          
sources, and it specifically supports semi-structured data formats like ORC and XML. ORC (Optimized Row                                                                                                                                                                                                                                                                                                                          
Columnar) is a columnar storage format optimized for Hadoop and is often used in data lake environments.                                                                                                                                                                                                                                                                                                                         
Snowflake can ingest ORC files directly, leveraging their columnar nature for efficient data processing. XML                                                                                                                                                                                                                                                                                                                     
(Extensible Markup Language) is a hierarchical markup language commonly used for data serialization.                                                                                                                                                                                                                                                                                                                             
Snowflake can parse XML documents and extract data into relational tables or variants. CSV and EDI are not                                                                                                                                                                                                                                                                                                                       
considered semi-structured formats that are directly processed with a COPY command. CSV is a delimiterseparated file considered structured and loaded as a file and not semi structured. EDI or Electronic Data                                                                                                                                                                                                                  
Interchange is not a data format for data loading in snowflake. HTML is a markup language for web content                                                                                                                                                                                                                                                                                                                        
and not supported as data file format in snowflake. Snowflake treats these formats as structured data using                                                                                                                                                                                                                                                                                                                      
file format parameters and a staging.                                                                                                                                                                                                                                                                                                                                                                                            
For further information, consult the official Snowflake documentation on supported data file                                                                                                                                                                                                                                                                                                                                     
types:https://docs.snowflake.com/en/sql-reference/sql/copy-into-table.html#requiredparametershttps://docs.snowflake.com/en/user-guide/data-load-transform.html#supported-file-formats                                                                                                                                                                                                                                            
</details>                                                                                                                                                                                                                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                                                                                                                                                                                                 
---                                                                                                                                                                                                                                                                                                                                                                                                                              
While loading data from a JSON file, what enables the removal of the outer array structure from the file and loads                                                                                                                                                                                                                                                                                                               
the records into separate table rows?                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                 
A. SKIP_BYTE_ORDER_MARK<br>B. STRIP_NULL_VALUE<br>C. STRIP_OUTER_ARRAY<br>D. STRIP_OUTER_ELEMENT                                                                                                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                                                                                                                                                                                                 
<details>                                                                                                                                                                                                                                                                                                                                                                                                                        
<summary><strong>âœ… Answer : </strong></summary>                                                                                                                                                                                                                                                                                                                                                                                 
<strong>C</strong>                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                 
The correct answer is C. STRIP_OUTER_ARRAY. Snowflake's COPY command, used for loading data from                                                                                                                                                                                                                                                                                                                                 
external files, offers options to handle various file structures. When dealing with JSON files containing a toplevel array of JSON objects, without STRIP_OUTER_ARRAY the entire array would be treated as a single row,                                                                                                                                                                                                         
rather than creating multiple rows from the individual objects. The STRIP_OUTER_ARRAY parameter                                                                                                                                                                                                                                                                                                                                  
instructs Snowflake to bypass this outer array structure, processing each object within the array as a                                                                                                                                                                                                                                                                                                                           
separate row to be inserted into the target table. This parameter enables a direct mapping of the individual                                                                                                                                                                                                                                                                                                                     
JSON objects' key-value pairs to corresponding columns in the table, based on column names or defined                                                                                                                                                                                                                                                                                                                            
mapping. Options A, B and D are used for different file handling requirements. SKIP_BYTE_ORDER_MARK is                                                                                                                                                                                                                                                                                                                           
used to ignore leading byte order marks, helpful when dealing with encoding issues. STRIP_NULL_VALUE is                                                                                                                                                                                                                                                                                                                          
not a valid option for the COPY command in Snowflake; there is no option to remove NULL values during load.                                                                                                                                                                                                                                                                                                                      
Option D, STRIP_OUTER_ELEMENT is also not a valid COPY option in Snowflake. Therefore, only the                                                                                                                                                                                                                                                                                                                                  
STRIP_OUTER_ARRAY option directly addresses the need to process individual elements within a JSON array                                                                                                                                                                                                                                                                                                                          
as separate table rows. Without it, all array elements would be loaded into a single row, often into a variant                                                                                                                                                                                                                                                                                                                   
column. Understanding how to handle the outer array structure of a JSON document is crucial when working                                                                                                                                                                                                                                                                                                                         
with semi-structured data in Snowflake.                                                                                                                                                                                                                                                                                                                                                                                          
Authoritative Links:                                                                                                                                                                                                                                                                                                                                                                                                             
Snowflake Documentation on COPY command options: https://docs.snowflake.com/en/sqlreference/sql/copy-into-table.html                                                                                                                                                                                                                                                                                                             
Snowflake Documentation on Loading JSON Data: https://docs.snowflake.com/en/guides/snowflake-dataloading-transform.html                                                                                                                                                                                                                                                                                                          
</details>                                                                                                                                                                                                                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                                                                                                                                                                                                 
---                                                                                                                                                                                                                                                                                                                                                                                                                              
A user has semi-structured data to load into Snowflake but is not sure what types of operations will need to be                                                                                                                                                                                                                                                                                                                  
performed on the data.                                                                                                                                                                                                                                                                                                                                                                                                           
Based on this situation, what type of column does Snowflake recommend be used?                                                                                                                                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                                                                                                                                                                                                 
A. ARRAY<br>B. OBJECT<br>C. TEXT<br>D. VARIANT                                                                                                                                                                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                                                                                                                                                                                                 
<details>                                                                                                                                                                                                                                                                                                                                                                                                                        
<summary><strong>âœ… Answer : </strong></summary>                                                                                                                                                                                                                                                                                                                                                                                 
<strong>D</strong>                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                 
The correct answer is D. VARIANT. Here's why:                                                                                                                                                                                                                                                                                                                                                                                    
Snowflake's VARIANT data type is designed specifically for handling semi-structured data, like JSON or Avro,where the schema might be inconsistent or evolve over time. Unlike ARRAY or OBJECT, which enforce a more                                                                                                                                                                                                             
rigid structure, VARIANT allows storing data with varying types and nested structures within the same                                                                                                                                                                                                                                                                                                                            
column. This flexibility is crucial when the user is uncertain about future operations, as it avoids the need to                                                                                                                                                                                                                                                                                                                 
define a strict schema upfront or alter it frequently.                                                                                                                                                                                                                                                                                                                                                                           
TEXT data type, while suitable for string-based information, is not optimal for semi-structured data that might                                                                                                                                                                                                                                                                                                                  
have complex hierarchies or multiple data types within it. Storing semi-structured data as text would hinder                                                                                                                                                                                                                                                                                                                     
Snowflake's native ability to query individual attributes and nested elements efficiently, essentially treating it                                                                                                                                                                                                                                                                                                               
as an opaque string.                                                                                                                                                                                                                                                                                                                                                                                                             
When data is loaded as VARIANT, Snowflake parses and stores it efficiently in a columnar format behind the                                                                                                                                                                                                                                                                                                                       
scenes, enabling robust querying and filtering on specific elements within the semi-structured data. This late                                                                                                                                                                                                                                                                                                                   
schema binding capability is a key advantage of VARIANT, allowing users to explore and transform the data                                                                                                                                                                                                                                                                                                                        
without knowing the exact structure during the initial load. If the user later determines a specific structure                                                                                                                                                                                                                                                                                                                   
becomes important, the data within the VARIANT column can be parsed to specific data types using SQL                                                                                                                                                                                                                                                                                                                             
functions. This allows for a flexible approach that does not restrict the possible operations the user can                                                                                                                                                                                                                                                                                                                       
perform on the data.                                                                                                                                                                                                                                                                                                                                                                                                             
The user's uncertainty about future operations is a direct match for the dynamic nature of the VARIANT data                                                                                                                                                                                                                                                                                                                      
type. It provides a flexible and performant way to handle evolving data schemas, making it the recommended                                                                                                                                                                                                                                                                                                                       
solution for the given scenario.                                                                                                                                                                                                                                                                                                                                                                                                 
For more information:                                                                                                                                                                                                                                                                                                                                                                                                            
Snowflake Documentation on VARIANT Data Type                                                                                                                                                                                                                                                                                                                                                                                     
Snowflake Blog on Semi-Structured Data                                                                                                                                                                                                                                                                                                                                                                                           
</details>                                                                                                                                                                                                                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                                                                                                                                                                                                 
---                                                                                                                                                                                                                                                                                                                                                                                                                              
What is the purpose of using the OBJECT_CONSTRUCT function with the COPY INTO command?                                                                                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                                                                                                                                                                                 
A. Reorder the rows in a relational table and then unload the rows into a file.<br>B. Convert the rows in a relational table to a single VARIANT column and then unload the rows into a file.<br>C. Reorder the data columns according to a target table definition and then unload the rows into the table.<br>D. Convert the rows in a source file to a single VARIANT column and then load the rows from the file to a variant
                                                                                                                                                                                                                                                                                                                                                                                                                                 
<details>                                                                                                                                                                                                                                                                                                                                                                                                                        
<summary><strong>âœ… Answer : </strong></summary>                                                                                                                                                                                                                                                                                                                                                                                 
<strong>B</strong>                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                 
The correct answer is B because OBJECT_CONSTRUCT is a Snowflake function that transforms relational                                                                                                                                                                                                                                                                                                                              
data (rows and columns) into a JSON-like structure represented as a VARIANT data type. When used with                                                                                                                                                                                                                                                                                                                            
COPY INTO, OBJECT_CONSTRUCT essentially packages each row of a table into a single VARIANT column.                                                                                                                                                                                                                                                                                                                               
This is particularly useful when exporting data to formats that work well with semi-structured data, such as                                                                                                                                                                                                                                                                                                                     
JSON or Avro, as the VARIANT type can seamlessly hold complex data structures. Instead of unloading                                                                                                                                                                                                                                                                                                                              
individual columns separately, OBJECT_CONSTRUCT enables you to unload the complete structure of each                                                                                                                                                                                                                                                                                                                             
row as a single, flexible entity. Option A, reordering rows, is generally unrelated to OBJECT_CONSTRUCT and                                                                                                                                                                                                                                                                                                                      
handled by other clauses like ORDER BY. Option C, reordering data columns based on target definitions,                                                                                                                                                                                                                                                                                                                           
would be more aligned with column mapping during the COPY INTO operation, not OBJECT_CONSTRUCTâ€™s                                                                                                                                                                                                                                                                                                                                 
transformation. Option D, transforming source file rows, is incorrect because OBJECT_CONSTRUCT is used                                                                                                                                                                                                                                                                                                                           
within the SQL context while operating on existing table data, not on the raw data in source files during                                                                                                                                                                                                                                                                                                                        
loading. It functions as an operation to transform existing tabular data to a variant data type when the copy is                                                                                                                                                                                                                                                                                                                 
executed. Therefore, OBJECT_CONSTRUCTâ€™s purpose in COPY INTO is to convert the relational data into a                                                                                                                                                                                                                                                                                                                            
VARIANT column, making it suitable for unloading data to semi-structured formats. This capability leverages                                                                                                                                                                                                                                                                                                                      
Snowflake's native support for semi-structured data.                                                                                                                                                                                                                                                                                                                                                                             
Authoritative Links:                                                                                                                                                                                                                                                                                                                                                                                                             
Snowflake Documentation on OBJECT_CONSTRUCT: https://docs.snowflake.com/en/sqlreference/functions/object_construct                                                                                                                                                                                                                                                                                                               
Snowflake Documentation on COPY INTO: https://docs.snowflake.com/en/sql-reference/sql/copy-into-table                                                                                                                                                                                                                                                                                                                            
Snowflake Documentation on Data Loading Considerations: https://docs.snowflake.com/en/user-guide/dataload-considerations                                                                                                                                                                                                                                                                                                         
</details>                                                                                                                                                                                                                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                                                                                                                                                                                                 
---                                                                                                                                                                                                                                                                                                                                                                                                                              
Which data type can be used to load semi-structured data files directly, without explicitly describing the                                                                                                                                                                                                                                                                                                                       
hierarchical structure of the data?                                                                                                                                                                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                                                                                                                                                                                 
A. TEXT<br>B. VARIANT<br>C. VARCHAR<br>D. VARBINARY                                                                                                                                                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                                                                                                                                                                                 
<details>                                                                                                                                                                                                                                                                                                                                                                                                                        
<summary><strong>âœ… Answer : </strong></summary>                                                                                                                                                                                                                                                                                                                                                                                 
<strong>B</strong>                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                 
The correct answer is B. VARIANT. Snowflake's VARIANT data type is specifically designed to                                                                                                                                                                                                                                                                                                                                      
store semi-structured data, such as JSON, Avro, ORC, Parquet, or XML, without requiring a                                                                                                                                                                                                                                                                                                                                        
predefined schema. This is crucial when handling data where the structure might vary from record                                                                                                                                                                                                                                                                                                                                 
to record or is not known in advance. Unlike traditional relational databases, Snowflake doesn't                                                                                                                                                                                                                                                                                                                                 
need explicit column definitions for every attribute in the hierarchical data. The VARIANT data                                                                                                                                                                                                                                                                                                                                  
type enables storing each object, array, or scalar value directly within a single column. This                                                                                                                                                                                                                                                                                                                                   
flexible approach is fundamental to cloud-native data warehousing, allowing for faster data                                                                                                                                                                                                                                                                                                                                      
ingestion and analysis on evolving datasets. TEXT, VARCHAR, and VARBINARY are all intended                                                                                                                                                                                                                                                                                                                                       
for simpler data structures. TEXT is for large text, VARCHAR for variable-length strings, and                                                                                                                                                                                                                                                                                                                                    
VARBINARY is for binary data. They lack the ability to handle the complex nesting and diverse                                                                                                                                                                                                                                                                                                                                    
datatypes present in semi-structured data natively. With VARIANT, Snowflake parses the semistructured data during query execution, allowing for retrieval of specific elements using path                                                                                                                                                                                                                                        
notation. This provides immense flexibility for analyzing data that may not conform to a fixed                                                                                                                                                                                                                                                                                                                                   
schema. The VARIANT data type is optimized for storage efficiency, utilizing internal compression                                                                                                                                                                                                                                                                                                                                
and data indexing. Hence, it is ideal for modern cloud data workloads where dealing with semistructured data is commonplace.Authoritative Links:                                                                                                                                                                                                                                                                                 
Snowflake Documentation on VARIANT Data Type: https://docs.snowflake.com/en/sqlreference/data-types-semistructured                                                                                                                                                                                                                                                                                                               
Snowflake Documentation on Data Loading: https://docs.snowflake.com/en/user-guide/data-load                                                                                                                                                                                                                                                                                                                                      
Snowflake Blog Post on Semi-Structured Data: https://www.snowflake.com/blog/semistructured-data-in-snowflake/                                                                                                                                                                                                                                                                                                                    
</details>                                                                                                                                                                                                                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                                                                                                                                                                                                 
---                                                                                                                                                                                                                                                                                                                                                                                                                              
What is the purpose of the STRIP_NULL_VALUES file format option when loading semi-structured data files into                                                                                                                                                                                                                                                                                                                     
Snowflake?                                                                                                                                                                                                                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                                                                                                                                                                                                 
A. It removes null values from all columns in the data.<br>B. It converts null values to empty strings during loading.<br>C. It skips rows with null values during the loading process.<br>D. It removes object or array elements containing null values.                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                                                                 
<details>                                                                                                                                                                                                                                                                                                                                                                                                                        
<summary><strong>âœ… Answer : </strong></summary>                                                                                                                                                                                                                                                                                                                                                                                 
<strong>D</strong>                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                 
The STRIP_NULL_VALUES file format option in Snowflake is specifically designed to                                                                                                                                                                                                                                                                                                                                                
manage null values within semi-structured data, particularly JSON or Avro files, during                                                                                                                                                                                                                                                                                                                                          
the loading process. Unlike options that handle nulls in structured data,                                                                                                                                                                                                                                                                                                                                                        
STRIP_NULL_VALUES operates at the element level within complex objects and arrays.                                                                                                                                                                                                                                                                                                                                               
It does not remove entire rows (as option C suggests) or alter values in simple columns                                                                                                                                                                                                                                                                                                                                          
(as implied by A and B). Instead, when set to TRUE, it eliminates object fields or array                                                                                                                                                                                                                                                                                                                                         
elements that have a null value. For example, in a JSON document "name": "John",                                                                                                                                                                                                                                                                                                                                                 
"age": null, "city": "London" , using STRIP_NULL_VALUES = TRUE would transform it to                                                                                                                                                                                                                                                                                                                                             
"name": "John", "city": "London" . This is crucial for data cleaning during the ingest                                                                                                                                                                                                                                                                                                                                           
process, as it reduces storage footprint and removes unnecessary null entries from the                                                                                                                                                                                                                                                                                                                                           
varianct column. The option provides better data organization and simplifies subsequent                                                                                                                                                                                                                                                                                                                                          
queries. It's a key functionality for efficient handling of variable data shapes within semi-structured files by removing null values at element or object level. This maintains                                                                                                                                                                                                                                                 
consistency for downstream processes, eliminating the need for repetitive data cleaning                                                                                                                                                                                                                                                                                                                                          
steps.                                                                                                                                                                                                                                                                                                                                                                                                                           
Authoritative Link:                                                                                                                                                                                                                                                                                                                                                                                                              
Snowflake Documentation on File Format Options                                                                                                                                                                                                                                                                                                                                                                                   
</details>                                                                                                                                                                                                                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                                                                                                                                                                                                 
---                                                                                                                                                                                                                                                                                                                                                                                                                              
What function should be used to convert JSON NULL values to SQL NULL values when loading data into a                                                                                                                                                                                                                                                                                                                             
Snowflake table?                                                                                                                                                                                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                                                                                                                                                                                                 
A. STRIP_OUTER_ARRAYS<br>B. STRIP_NULL_VALUE<br>C. FLATTEN<br>D. PARSE_JSON                                                                                                                                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                                                                                                                                                                                                 
<details>                                                                                                                                                                                                                                                                                                                                                                                                                        
<summary><strong>âœ… Answer : </strong></summary>                                                                                                                                                                                                                                                                                                                                                                                 
<strong>D</strong>                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                 
The Correct answer is ["D"]                                                                                                                                                                                                                                                                                                                                                                                                      
</details>                                                                                                                                                                                                                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                                                                                                                                                                                                 

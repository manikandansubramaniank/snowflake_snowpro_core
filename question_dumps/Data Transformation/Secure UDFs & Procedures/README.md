# Secure UDFs & Procedures                                                                                                                                                                                                                                                                                                                                                                                                        
What should be considered when deciding to use a Secure View? (Choose two.)                                                                                                                                                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                                                                                                                                                                                                  
A. No details of the query execution plan will be available in the query profiler.<br>B. Once created there is no way to determine if a view is secure or not.<br>C. Secure views do not take advantage of the same internal optimizations as standard views.<br>D. It is not possible to create secure materialized views.<br>E. The view definition of a secure view is still visible to users by way of the information schema.
                                                                                                                                                                                                                                                                                                                                                                                                                                  
<details>                                                                                                                                                                                                                                                                                                                                                                                                                         
<summary><strong>✅ Answer : </strong></summary>                                                                                                                                                                                                                                                                                                                                                                                  
<strong>A, C</strong>                                                                                                                                                                                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                                                                                                                                                                                  
The correct answer is AC. Secure Views in Snowflake are designed to protect sensitive data by controlling                                                                                                                                                                                                                                                                                                                         
access at the row level and column level, without revealing the underlying query logic or data structure.                                                                                                                                                                                                                                                                                                                         
A is correct because Secure Views do indeed hide the execution plan from the query profiler. This is a key                                                                                                                                                                                                                                                                                                                        
security feature, as it prevents users from understanding how the query is being executed, potentially                                                                                                                                                                                                                                                                                                                            
exposing underlying data access patterns. This obfuscation limits insights into data sources and join                                                                                                                                                                                                                                                                                                                             
strategies, safeguarding against reverse engineering and data exposure.                                                                                                                                                                                                                                                                                                                                                           
C is correct because Secure Views often do not benefit from the same level of optimization as regular views.                                                                                                                                                                                                                                                                                                                      
Snowflake might have to perform extra steps during processing for secure views to enforce the data masking                                                                                                                                                                                                                                                                                                                        
and row level security. This can sometimes lead to slight performance overhead compared to a standard view.                                                                                                                                                                                                                                                                                                                       
Consequently, you should carefully consider performance implications when choosing a secure view.                                                                                                                                                                                                                                                                                                                                 
B is incorrect because Snowflake provides ways to identify whether a view is secure or not. Using the SHOW                                                                                                                                                                                                                                                                                                                        
VIEWS command and inspecting the is_secure property allows one to check the security status.                                                                                                                                                                                                                                                                                                                                      
D is incorrect since it is possible to create secure materialized views. Materialized views are a separate object                                                                                                                                                                                                                                                                                                                 
type that can be either secure or not. The security attribute is managed similarly to non-materialized views.                                                                                                                                                                                                                                                                                                                     
E is incorrect because a core feature of Secure Views is that their definition is hidden from users in the                                                                                                                                                                                                                                                                                                                        
information schema. The query logic itself is masked ensuring that users cannot glean sensitive details aboutdata structures or column mappings via information schema.                                                                                                                                                                                                                                                           
Therefore, the primary considerations when choosing to use a Secure View should be the potential loss of                                                                                                                                                                                                                                                                                                                          
query execution insights and the potential impact on performance optimization.                                                                                                                                                                                                                                                                                                                                                    
Authoritative Links:                                                                                                                                                                                                                                                                                                                                                                                                              
Snowflake Documentation on Secure Views: https://docs.snowflake.com/en/user-guide/views-secure.html                                                                                                                                                                                                                                                                                                                               
Snowflake Documentation on View Security: https://docs.snowflake.com/en/user-guide/security-views.html                                                                                                                                                                                                                                                                                                                            
</details>                                                                                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                                                                                                                                                                                                  
---                                                                                                                                                                                                                                                                                                                                                                                                                               
What is used to extract the content of PDF files stored in Snowflake stages?                                                                                                                                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                                                                                                                                                                                                  
A. FLATTEN function<br>B. Window function<br>C. HyperLogLog (HLL) function<br>D. Java User-Defined Function (UDF)                                                                                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                                                                                                                                                                                                  
<details>                                                                                                                                                                                                                                                                                                                                                                                                                         
<summary><strong>✅ Answer : </strong></summary>                                                                                                                                                                                                                                                                                                                                                                                  
<strong>D</strong>                                                                                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                                                                  
The correct answer is D, a Java User-Defined Function (UDF). Snowflake doesn't natively support extracting                                                                                                                                                                                                                                                                                                                        
content directly from PDF files stored in stages using built-in functions like FLATTEN, Window functions, or                                                                                                                                                                                                                                                                                                                      
HyperLogLog (HLL) functions. These functions serve different purposes: FLATTEN is for flattening semistructured data, window functions perform calculations across a set of table rows that are related to the                                                                                                                                                                                                                    
current row, and HLL functions are for cardinality estimation.                                                                                                                                                                                                                                                                                                                                                                    
Extracting content from PDFs requires specialized libraries capable of parsing the PDF format. A Java UDF                                                                                                                                                                                                                                                                                                                         
provides a mechanism to extend Snowflake's functionality by incorporating external Java code. You can                                                                                                                                                                                                                                                                                                                             
include a Java library such as PDFBox or iText within a UDF to parse the PDF files located in a Snowflake                                                                                                                                                                                                                                                                                                                         
stage. The UDF then reads the PDF file from the stage, uses the library to extract the text or other data, and                                                                                                                                                                                                                                                                                                                    
returns the extracted content as a string or other suitable data type.                                                                                                                                                                                                                                                                                                                                                            
The process typically involves creating a Java class with a method that takes the stage path of the PDF as                                                                                                                                                                                                                                                                                                                        
input, uses the Java PDF library to read and parse the file, and returns the desired content. You then upload                                                                                                                                                                                                                                                                                                                     
the compiled JAR file to an internal stage in Snowflake and register the UDF, pointing it to the Java class and                                                                                                                                                                                                                                                                                                                   
method. This allows you to query the PDF data directly using SQL, invoking the UDF as needed. Snowflake                                                                                                                                                                                                                                                                                                                           
executes the Java code within its secure environment.                                                                                                                                                                                                                                                                                                                                                                             
Using a Java UDF allows for flexible extraction of PDF content, including text, tables, or metadata, enabling                                                                                                                                                                                                                                                                                                                     
further analysis and integration of the extracted data within Snowflake. This approach leverages the                                                                                                                                                                                                                                                                                                                              
extensibility of Snowflake to handle file types and parsing requirements beyond the native capabilities.                                                                                                                                                                                                                                                                                                                          
For further research, refer to the following resources:                                                                                                                                                                                                                                                                                                                                                                           
Snowflake UDFs: https://docs.snowflake.com/en/developer-guide/udf/java/udf-java-creating                                                                                                                                                                                                                                                                                                                                          
Apache PDFBox: https://pdfbox.apache.org/                                                                                                                                                                                                                                                                                                                                                                                         
iText: https://itextpdf.com/en                                                                                                                                                                                                                                                                                                                                                                                                    
</details>                                                                                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                                                                                                                                                                                                  
---                                                                                                                                                                                                                                                                                                                                                                                                                               
What is used to extract the content of PDF files stored in Snowflake stages?                                                                                                                                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                                                                                                                                                                                                  
A. FLATTEN function<br>B. Window function<br>C. HyperLogLog (HLL) function<br>D. Java User-Defined Function (UDF)                                                                                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                                                                                                                                                                                                  
<details>                                                                                                                                                                                                                                                                                                                                                                                                                         
<summary><strong>✅ Answer : </strong></summary>                                                                                                                                                                                                                                                                                                                                                                                  
<strong>D</strong>                                                                                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                                                                  
The correct answer is D. Java User-Defined Function (UDF). Snowflake's built-in functions like FLATTEN,                                                                                                                                                                                                                                                                                                                           
window functions, and HyperLogLog (HLL) functions are not designed to process the binary content of PDF                                                                                                                                                                                                                                                                                                                           
files. Extracting text from PDFs requires more sophisticated parsing logic, often involving libraries capable of                                                                                                                                                                                                                                                                                                                  
understanding the PDF file format. This functionality is not available natively in Snowflake SQL.                                                                                                                                                                                                                                                                                                                                 
Java UDFs allow you to extend Snowflake's capabilities by writing custom code in Java that can interact with                                                                                                                                                                                                                                                                                                                      
external libraries. In this case, a Java UDF could leverage a PDF parsing library like Apache PDFBox or iText to                                                                                                                                                                                                                                                                                                                  
read the PDF binary data from a stage, extract the text, and return it as a result usable within Snowflake.                                                                                                                                                                                                                                                                                                                       
The FLATTEN function (A) is used for unnesting array or object structures, and it is not suitable for parsing                                                                                                                                                                                                                                                                                                                     
binary PDF content. Window functions (B) operate on sets of rows and are for analytical purposes, not                                                                                                                                                                                                                                                                                                                             
document extraction. HLL functions (C) estimate the cardinality of sets and are irrelevant here.                                                                                                                                                                                                                                                                                                                                  
Therefore, a Java UDF is the most appropriate method to handle the specific task of reading and parsing the                                                                                                                                                                                                                                                                                                                       
complex structure of PDF documents stored in Snowflake stages due to its ability to utilize external libraries.                                                                                                                                                                                                                                                                                                                   
Authoritative Links:                                                                                                                                                                                                                                                                                                                                                                                                              
Snowflake User-Defined Functions (UDFs): https://docs.snowflake.com/en/sql-reference/udf-java                                                                                                                                                                                                                                                                                                                                     
Apache PDFBox: https://pdfbox.apache.org/                                                                                                                                                                                                                                                                                                                                                                                         
iText: https://itextpdf.com/                                                                                                                                                                                                                                                                                                                                                                                                      
</details>                                                                                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                                                                                                                                                                                                  
---                                                                                                                                                                                                                                                                                                                                                                                                                               
A Snowflake user is writing a User-Defined Function (UDF) with some unqualified object names.                                                                                                                                                                                                                                                                                                                                     
How will those object names be resolved during execution?                                                                                                                                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                                                                                                                                                                                                  
A. Snowflake will resolve them according to the SEARCH_PATH parameter.<br>B. Snowflake will only check the schema the UDF belongs to.<br>C. Snowflake will first check the current schema, and then the schema the previous query used.<br>D. Snowflake will first check the current schema, and then the PUBLIC schema of the current database.                                                                                  
                                                                                                                                                                                                                                                                                                                                                                                                                                  
<details>                                                                                                                                                                                                                                                                                                                                                                                                                         
<summary><strong>✅ Answer : </strong></summary>                                                                                                                                                                                                                                                                                                                                                                                  
<strong>B</strong>                                                                                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                                                                  
The correct answer is B. Snowflake will only check the schema the UDF belongs to.                                                                                                                                                                                                                                                                                                                                                 
When a User-Defined Function (UDF) in Snowflake executes, unqualified object names (like table or view                                                                                                                                                                                                                                                                                                                            
names without a specified schema) are resolved within the context of the UDF's own schema, not the user's                                                                                                                                                                                                                                                                                                                         
current session schema or any search path. This isolation ensures the UDF's behavior is predictable and                                                                                                                                                                                                                                                                                                                           
consistent, independent of where it's called from. Snowflake prioritizes the UDF's schema for resolving                                                                                                                                                                                                                                                                                                                           
unqualified names. If an object isn't found within that schema, the UDF execution will fail. The SEARCH_PATH                                                                                                                                                                                                                                                                                                                      
parameter, while used in the context of queries outside UDFs, does not influence the name resolution within                                                                                                                                                                                                                                                                                                                       
UDFs. Options C and D are incorrect since UDFs do not adhere to the precedence described. A UDF operates                                                                                                                                                                                                                                                                                                                          
within a defined scope, which is crucial for maintaining data integrity and avoiding unexpected conflicts when                                                                                                                                                                                                                                                                                                                    
the function is used in different scenarios with varying database contexts. This approach enhances the                                                                                                                                                                                                                                                                                                                            
modularity and reusability of UDFs in Snowflake.                                                                                                                                                                                                                                                                                                                                                                                  
Authoritative Links:                                                                                                                                                                                                                                                                                                                                                                                                              
Snowflake Documentation on UDFs: https://docs.snowflake.com/en/sql-reference/udf-overview.html (This                                                                                                                                                                                                                                                                                                                              
link provides an overview of UDFs and their behavior)                                                                                                                                                                                                                                                                                                                                                                             
Snowflake Documentation on Schema Resolution: https://docs.snowflake.com/en/sql-reference/nameresolution.html (This link explains Snowflake's name resolution process in detail.)                                                                                                                                                                                                                                                 
</details>                                                                                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                                                                                                                                                                                                  
---                                                                                                                                                                                                                                                                                                                                                                                                                               
How do secure views compare to non-secure views in Snowflake?                                                                                                                                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                                                                                                                                                                                  
A. Secure views execute slowly compared to non-secure views.<br>B. Non-secure views are preferred over secure views when sharing data.<br>C. Secure views are similar to materialized views in that they are the most performant.<br>D. There are no performance differences between secure and non-secure views.                                                                                                                 
                                                                                                                                                                                                                                                                                                                                                                                                                                  
<details>                                                                                                                                                                                                                                                                                                                                                                                                                         
<summary><strong>✅ Answer : </strong></summary>                                                                                                                                                                                                                                                                                                                                                                                  
<strong>A</strong>                                                                                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                                                                  
The correct answer is indeed A. Secure views execute slowly compared to non-secure views. This stems                                                                                                                                                                                                                                                                                                                              
from the fundamental difference in how Snowflake handles access control and query processing for these                                                                                                                                                                                                                                                                                                                            
view types. Secure views enforce row-level and column-level security at query time. This means Snowflake                                                                                                                                                                                                                                                                                                                          
must meticulously check the privileges of the user executing the query against the data underlying the                                                                                                                                                                                                                                                                                                                            
secure view. This constant security evaluation introduces overhead, resulting in slower execution compared to                                                                                                                                                                                                                                                                                                                     
non-secure views. Non-secure views, in contrast, simply present a pre-defined query's result set, skipping                                                                                                                                                                                                                                                                                                                        
these additional security checks. They lack the granularity of access control offered by secure views. While                                                                                                                                                                                                                                                                                                                      
secure views prioritize data protection, they come at the cost of performance.                                                                                                                                                                                                                                                                                                                                                    
Therefore, option B is incorrect because non-secure views are not preferred when sharing sensitive data;                                                                                                                                                                                                                                                                                                                          
secure views are the appropriate choice. Option C is also incorrect as secure views do not function similarly to                                                                                                                                                                                                                                                                                                                  
materialized views regarding performance. Materialized views typically offer faster query performance due to                                                                                                                                                                                                                                                                                                                      
pre-computed results, which contrasts secure view's runtime security checks. Option D is incorrect because,                                                                                                                                                                                                                                                                                                                       
as explained, there are performance differences, with secure views typically performing slower. The added                                                                                                                                                                                                                                                                                                                         
layer of access control inherent to secure views inevitably impacts their speed. Snowflake's documentation                                                                                                                                                                                                                                                                                                                        
details these differences, making it clear that security trade-offs sometimes come with a performance cost.                                                                                                                                                                                                                                                                                                                       
Therefore, A accurately captures the performance difference between the two view types.                                                                                                                                                                                                                                                                                                                                           
Authoritative Links:                                                                                                                                                                                                                                                                                                                                                                                                              
Snowflake Documentation on Secure Views: https://docs.snowflake.com/en/user-guide/views-secure.html                                                                                                                                                                                                                                                                                                                               
Snowflake Documentation on Views: https://docs.snowflake.com/en/user-guide/views-intro.html                                                                                                                                                                                                                                                                                                                                       
</details>                                                                                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                                                                                                                                                                                                  
---                                                                                                                                                                                                                                                                                                                                                                                                                               
Which languages require that User-Defined Function (UDF) handlers be written inline? (Choose two.)                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                                                                  
A. Java<br>B. Javascript<br>C. Scala<br>D. Python<br>E. SQL                                                                                                                                                                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                                                                                                                                                                                                  
<details>                                                                                                                                                                                                                                                                                                                                                                                                                         
<summary><strong>✅ Answer : </strong></summary>                                                                                                                                                                                                                                                                                                                                                                                  
<strong>B, E</strong>                                                                                                                                                                                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                                                                                                                                                                                  
The question asks about languages that require inline handlers for Snowflake UserDefined Functions (UDFs). Inline UDF handlers mean the code defining the function logicmust be directly embedded within the CREATE FUNCTION statement. Snowflake                                                                                                                                                                                 
supports multiple languages for UDFs, and not all require inline handlers.                                                                                                                                                                                                                                                                                                                                                        
JavaScript and SQL are the two languages that mandate inline handlers within the                                                                                                                                                                                                                                                                                                                                                  
CREATE FUNCTION statement when used for UDFs in Snowflake. This design is because                                                                                                                                                                                                                                                                                                                                                 
both languages are interpreted and can be directly parsed and executed by the                                                                                                                                                                                                                                                                                                                                                     
Snowflake engine without a need for a separate compilation or deployment step. Java,                                                                                                                                                                                                                                                                                                                                              
Scala, and Python, on the other hand, support writing UDF handlers in external files,                                                                                                                                                                                                                                                                                                                                             
which can then be referenced in the CREATE FUNCTION statement, allowing for more                                                                                                                                                                                                                                                                                                                                                  
structured and complex code development. These external handlers can be packaged as                                                                                                                                                                                                                                                                                                                                               
JAR files (for Java and Scala) or as zipped files containing Python code.                                                                                                                                                                                                                                                                                                                                                         
The choice of requiring inline code for JavaScript and SQL stems from their nature as                                                                                                                                                                                                                                                                                                                                             
simpler, scripting-style languages, which typically don't involve separate compilation                                                                                                                                                                                                                                                                                                                                            
steps like Java, Scala, or Python. This simplifies the creation and deployment of simple                                                                                                                                                                                                                                                                                                                                          
functions in Snowflake when using these languages. For more intricate, long-form                                                                                                                                                                                                                                                                                                                                                  
functionality, users would typically opt for Java, Scala, or Python, with external handlers                                                                                                                                                                                                                                                                                                                                       
facilitating structured development practices and code reusability.                                                                                                                                                                                                                                                                                                                                                               
In short, the requirement of inline handlers is a design decision based on the language’s                                                                                                                                                                                                                                                                                                                                         
nature and ease of use in simple scenarios, and it's a deliberate design choice within the                                                                                                                                                                                                                                                                                                                                        
Snowflake UDF architecture.                                                                                                                                                                                                                                                                                                                                                                                                       
Authoritative links:                                                                                                                                                                                                                                                                                                                                                                                                              
Snowflake Documentation on UDFs: Provides general information on UDFs, including                                                                                                                                                                                                                                                                                                                                                  
language support.                                                                                                                                                                                                                                                                                                                                                                                                                 
Snowflake Documentation on JavaScript UDFs: Specifically details how JavaScript UDFs                                                                                                                                                                                                                                                                                                                                              
function in Snowflake, including inline requirements.                                                                                                                                                                                                                                                                                                                                                                             
Snowflake Documentation on SQL UDFs: Shows how SQL UDFs are defined and that the                                                                                                                                                                                                                                                                                                                                                  
code is provided inline.                                                                                                                                                                                                                                                                                                                                                                                                          
Snowflake Documentation on External Handlers for Python : Shows that external                                                                                                                                                                                                                                                                                                                                                     
handlers are allowed for Python UDFs.                                                                                                                                                                                                                                                                                                                                                                                             
</details>                                                                                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                                                                                                                                                                                                  

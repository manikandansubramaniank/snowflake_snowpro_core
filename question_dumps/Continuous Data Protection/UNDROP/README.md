# UNDROP                                                                                                                                                                                                                                                                
Which of the following objects can be directly restored using the UNDROP command? (Choose two.)                                                                                                                                                                         
                                                                                                                                                                                                                                                                        
A. Schema<br>B. View<br>C. Internal stage<br>D. Table<br>E. User<br>F. Role                                                                                                                                                                                             
                                                                                                                                                                                                                                                                        
<details>                                                                                                                                                                                                                                                               
<summary><strong>✅ Answer : </strong></summary>                                                                                                                                                                                                                        
<strong>A, D</strong>                                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                                        
The correct answer is A. Schema and D. Table. Snowflake's UNDROP command is specifically designed to                                                                                                                                                                    
restore objects that have been intentionally or unintentionally dropped. This functionality is crucial for data                                                                                                                                                         
recovery and maintaining system stability. The UNDROP operation is not applicable to every type of object                                                                                                                                                               
within Snowflake, hence limiting the correct choices.                                                                                                                                                                                                                   
Schemas, which are organizational containers for database objects like tables and views, can be restored to                                                                                                                                                             
their prior state with UNDROP. Similarly, tables, the primary data storage structures, are directly supported                                                                                                                                                           
by the UNDROP mechanism. This ensures data recovery from accidental deletion.                                                                                                                                                                                           
Views, while being database objects, are dependent on underlying tables, so they aren’t restored using                                                                                                                                                                  
UNDROP; instead, they need to be recreated if the underlying tables are restored. Internal stages, utilized for                                                                                                                                                         
data loading, do not qualify for UNDROP because their dropped data and metadata are not held in the same                                                                                                                                                                
way that database object metadata is held. Users and Roles, which control access to the Snowflake                                                                                                                                                                       
environment, also cannot be directly restored with the UNDROP command. They would require re-creation.                                                                                                                                                                  
UNDROP primarily focuses on the structural components of the data layer – schemas and tables.                                                                                                                                                                           
Authoritative Links for further research:                                                                                                                                                                                                                               
1. Snowflake Documentation on UNDROP: https://docs.snowflake.com/en/sql-reference/sql/undrop                                                                                                                                                                            
2. Snowflake Documentation on Data Recovery: https://docs.snowflake.com/en/user-guide/datarecovery                                                                                                                                                                      
</details>                                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                        
---                                                                                                                                                                                                                                                                     
User A cloned a schema and overwrote a schema that User B was working on. User B no longer has access to their                                                                                                                                                          
version of the tables. However, this all occurred within the Time Travel retention period defined at the database                                                                                                                                                       
level.                                                                                                                                                                                                                                                                  
How should the missing tables be restored?                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                        
A. Use an UNDROP TABLE statement.<br>B. Use a CREATE TABLE AS SELECT statement<br>C. Rename the cloned schema and use an UNDROP SCHEMA statement.<br>D. Contact Snowflake Support to retrieve the data from Fail-safe                                                   
                                                                                                                                                                                                                                                                        
<details>                                                                                                                                                                                                                                                               
<summary><strong>✅ Answer : </strong></summary>                                                                                                                                                                                                                        
<strong>C</strong>                                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                                        
The correct method to restore the schema and its tables in this scenario is option C: Rename the cloned                                                                                                                                                                 
schema and use an UNDROP SCHEMA statement.                                                                                                                                                                                                                              
Here's why:                                                                                                                                                                                                                                                             
1. Schema Overwrite: User A's clone operation overwrote User B's schema. This means the original                                                                                                                                                                        
schema, while potentially within the Time Travel period, is effectively gone from its original name and                                                                                                                                                                 
location.                                                                                                                                                                                                                                                               
2. Time Travel Scope: Time Travel operates at the object level (schemas, tables, databases). Since the                                                                                                                                                                  
entire schema was overwritten, UNDROP SCHEMA is the most efficient and appropriate method.                                                                                                                                                                              
3. UNDROP SCHEMA: The UNDROP SCHEMA command allows you to restore a schema that has been                                                                                                                                                                                
dropped, provided it's within the Time Travel retention period. In this case, since the schema was                                                                                                                                                                      
overwritten rather than explicitly dropped, the UNDROP SCHEMA command will effectively restore                                                                                                                                                                          
the previous version of the schema, including the tables within it, by renaming the newly cloned                                                                                                                                                                        
schema first and then using UNDROP SCHEMA.                                                                                                                                                                                                                              
4. Alternative Considerations:                                                                                                                                                                                                                                          
UNDROP TABLE: An UNDROP TABLE statement wouldn't work directly because the schema itself                                                                                                                                                                                
has been replaced. You'd need to know the exact names of all the tables and restore them                                                                                                                                                                                
individually. This is much more tedious and error-prone than restoring the entire schema.                                                                                                                                                                               
CREATE TABLE AS SELECT: This is generally used to create a new table from an existing one or                                                                                                                                                                            
from a query. It does not restore a dropped table.                                                                                                                                                                                                                      
Snowflake Support/Fail-safe: Fail-safe is for disaster recovery situations and isn't intended for                                                                                                                                                                       
restoring accidentally overwritten objects within the Time Travel window. Contacting support is                                                                                                                                                                         
unnecessary in this situation.                                                                                                                                                                                                                                          
5. Efficiency: Restoring the entire schema is more efficient than restoring each table individually if a                                                                                                                                                                
whole schema was unintentionally replaced.Therefore, renaming the current cloned schema and                                                                                                                                                                             
using UNDROP SCHEMA is the most practical and direct method to recover User B's original tables                                                                                                                                                                         
and schema.                                                                                                                                                                                                                                                             
Authoritative Links:                                                                                                                                                                                                                                                    
Snowflake Time Travel: https://docs.snowflake.com/en/user-guide/data-recovery-time-travel.htmlUNDROP SCHEMA: https://docs.snowflake.com/en/sql-reference/sql/undrop-schema.html                                                                                         
</details>                                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                        
---                                                                                                                                                                                                                                                                     
How can a dropped internal stage be restored?                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                        
A. Enable Time Travel.<br>B. Clone the dropped stage.<br>C. Execute the UNDROP command.<br>D. Recreate the dropped stage.                                                                                                                                               
                                                                                                                                                                                                                                                                        
<details>                                                                                                                                                                                                                                                               
<summary><strong>✅ Answer : </strong></summary>                                                                                                                                                                                                                        
<strong>D</strong>                                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                                        
The correct answer is D. Recreate the dropped stage. Here's why:                                                                                                                                                                                                        
Snowflake's Time Travel feature, while powerful, does not apply to internal stages. Time                                                                                                                                                                                
Travel primarily safeguards tables, schemas, and databases. When an internal stage is                                                                                                                                                                                   
dropped, it's not recoverable through Time Travel mechanisms. Similarly, cloning a                                                                                                                                                                                      
dropped stage is not an option, as the stage no longer exists to be cloned. The UNDROP                                                                                                                                                                                  
command is specifically designed for restoring tables, schemas, and databases that                                                                                                                                                                                      
have been dropped and is not applicable to internal stages.                                                                                                                                                                                                             
Internal stages are effectively containers for files used within Snowflake; dropping them                                                                                                                                                                               
removes the stage definition, making the associated location inaccessible. Therefore, to                                                                                                                                                                                
bring the internal stage back, it must be recreated. This involves issuing the CREATE                                                                                                                                                                                   
STAGE command, specifying the same name and configurations as the original dropped                                                                                                                                                                                      
stage. This action essentially sets up a new storage location with the same label and                                                                                                                                                                                   
properties. The files themselves, if they still exist in the underlying storage, may be                                                                                                                                                                                 
accessed via the new stage. However, remember that metadata specific to the stage is                                                                                                                                                                                    
lost when dropped.                                                                                                                                                                                                                                                      
For further information on Snowflake stages and Time Travel, refer to the official                                                                                                                                                                                      
documentation:                                                                                                                                                                                                                                                          
Snowflake Stages: https://docs.snowflake.com/en/user-guide/data-load-stages.html                                                                                                                                                                                        
Snowflake Time Travel: https://docs.snowflake.com/en/user-guide/data-timetravel.html                                                                                                                                                                                    
Snowflake UNDROP command: https://docs.snowflake.com/en/sqlreference/sql/undrop.html                                                                                                                                                                                    
The key takeaway is that dropped internal stages do not benefit from Time Travel,                                                                                                                                                                                       
UNDROP command, or cloning functionalities; recreation via CREATE STAGE is the sole                                                                                                                                                                                     
method of recovery.                                                                                                                                                                                                                                                     
</details>                                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                        
---                                                                                                                                                                                                                                                                     
When a transient table in Snowflake is dropped, what happens to the table?                                                                                                                                                                                              
                                                                                                                                                                                                                                                                        
A. The table is no longer available for use.<br>B. The table can be undropped using Fail-safe.<br>C. The table can be recovered for 1 day only and after that it is no longer available.<br>D. The table can be recovered only with the assistance of Snowflake Support.
                                                                                                                                                                                                                                                                        
<details>                                                                                                                                                                                                                                                               
<summary><strong>✅ Answer : </strong></summary>                                                                                                                                                                                                                        
<strong>C</strong>                                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                                        
The Correct answer is ["C"]                                                                                                                                                                                                                                             
</details>                                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                        
